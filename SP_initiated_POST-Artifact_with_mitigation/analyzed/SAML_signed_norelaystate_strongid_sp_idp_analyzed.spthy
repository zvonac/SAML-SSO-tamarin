theory SAML_signed_norelaystate_strongid begin

// Function signature and definition of the equational theory E

functions: fst/1, https_request/3 [private], https_response/2 [private],
           pair/2, pk/1, sign/2, snd/1, true/0, verify/3
equations:
    fst(<x.1, x.2>) = x.1,
    snd(<x.1, x.2>) = x.2,
    verify(sign(x.1, x.2), x.1, pk(x.2)) = true



rule (modulo E) Initialize_Agent:
   [ Fr( ~ltk ), Fr( ~clientID ) ]
  --[
  Initialize_Agent( $Agent ), Agent_Key( $Agent, ~ltk ),
  Agent_ID( $Agent, ~clientID )
  ]->
   [
   Agent_Initialized( $Agent ), !Is_Agent( $Agent ),
   !Pk( $Agent, pk(~ltk) ), !Ltk( $Agent, ~ltk ),
   !ClientID( $Agent, ~clientID ), Out( pk(~ltk) ), Out( ~clientID )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Compromise_Agent[color=#f5b7b1]:
   [ Agent_Initialized( $Agent ), !Ltk( $Agent, ~ltk ) ]
  --[ Compromise_Agent( $Agent ) ]->
   [ !Agent_Compromised( $Agent ), Out( ~ltk ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Initialize_SP[color=#e0ffff]:
   [ Agent_Initialized( $SP ) ]
  --[ Initialize_SP( $SP ) ]->
   [ !SP_Initialized( $SP ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Initialize_IdP[color=#fafad2]:
   [ Agent_Initialized( $IdP ) ]
  --[ Initialize_IdP( $IdP ) ]->
   [ !IdP_Initialized( $IdP ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Initialize_Client[color=#add8e6]:
   [ Agent_Initialized( $C ) ]
  --[ Initialize_Client( $C ) ]->
   [ !Client_Initialized( $C ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Register_Client_at_IdP[color=#add8e6]:
   [
   !Client_Initialized( $C ), !IdP_Initialized( $IdP ),
   !ClientID( $C, ~clientID ), Fr( ~clientSecret )
   ]
  --[ Register_Client_at_IdP( $C, $IdP, ~clientID, ~clientSecret ) ]->
   [ !Client_Registered_at_IdP( $IdP, ~clientID, ~clientSecret ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Adversary_Register_Client_at_IdP[color=#f5b7b1]:
   [
   !Agent_Compromised( $C ), !IdP_Initialized( $IdP ),
   !ClientID( $C, ~clientID ), Fr( ~clientSecret )
   ]
  --[
  Adversary_Register_Client_at_IdP( $C, $IdP, ~clientID, ~clientSecret )
  ]->
   [
   !Client_Registered_at_IdP( $IdP, ~clientID, ~clientSecret ),
   Out( ~clientSecret )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Register_Client_at_Compromised_IdP[color=#f5b7b1]:
   [
   !Client_Initialized( $C ), !Agent_Compromised( $IdP ),
   !ClientID( $C, ~clientID ), Fr( ~clientSecret )
   ]
  --[
  Register_Client_at_Compromised_IdP( $C, $IdP, ~clientID, ~clientSecret )
  ]->
   [
   !Client_Registered_at_IdP( $IdP, ~clientID, ~clientSecret ),
   Out( ~clientSecret )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Register_Resource_at_SP[color=#fafad2]:
   [
   !Client_Initialized( $C ), !SP_Initialized( $SP ),
   !ClientID( $C, ~clientID ), Fr( ~res )
   ]
  --[ Register_Resource_at_SP( $C, $SP, ~clientID, ~res, $url ) ]->
   [
   !Client_Has_Resource( $SP, ~clientID, $url, ~res ),
   !Is_Resource( $url, $SP )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Adversary_Register_Resource_at_SP[color=#fafad2]:
   [
   !Agent_Compromised( $C ), !SP_Initialized( $SP ),
   !ClientID( $C, ~clientID ), Fr( ~res )
   ]
  --[ Adversary_Register_Resource_at_SP( $C, $SP, ~clientID, ~res, $url )
  ]->
   [
   !Client_Has_Resource( $SP, ~clientID, $url, ~res ), Out( ~res ),
   !Is_Resource( $url, $SP )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Register_Resource_at_Compromised_SP[color=#fafad2]:
   [ !Agent_Compromised( $SP ) ]
  --[ Register_Resource_at_Compromised_SP( $SP, $url ) ]->
   [ !Is_Resource( $url, $SP ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Register_SP_at_IdP[color=#fafad2]:
   [ !Is_Agent( $SP ), !Is_Agent( $IdP ) ]
  --[ Register_SP_at_IdP( $SP, $IdP ) ]->
   [ !Is_Registered( $SP, $IdP ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Client_Starts_TLS:
   [ Fr( ~tls_session_id ), !Is_Agent( $Client ), !Is_Agent( $Server ) ]
  --[ Client_Starts_TLS( $Client, $Server, ~tls_session_id ) ]->
   [
   New_Client_TLS_Session( $Client, $Server, ~tls_session_id ),
   New_Server_TLS_Session( $Server, ~tls_session_id )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Adversary_Sends_as_Client[color=#f5b7b1]:
   [
   In( message ),
   New_Client_TLS_Session( $Agent, $Server, ~tls_session_id ),
   !Agent_Compromised( $Agent )
   ]
  -->
   [
   Out( https_request($Server, ~tls_session_id, message) ),
   St_Adversary_Client_TLS_Session( ~tls_session_id )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Adversary_Receives_as_Client[color=#f5b7b1]:
   [
   St_Adversary_Client_TLS_Session( ~tls_session_id ),
   In( https_response(~tls_session_id, message) )
   ]
  --[
  Adversary_Receives_as_Client( https_response(~tls_session_id, message) )
  ]->
   [ Out( message ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Adversary_Receives_as_Server[color=#f5b7b1]:
   [
   In( https_request($Agent, ~tls_session_id, message) ),
   !Agent_Compromised( $Agent )
   ]
  --[
  Adversary_Receives_as_Server( https_request($Agent, ~tls_session_id,
                                              message)
  )
  ]->
   [ Out( message ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Adversary_Sends_as_Server[color=#f5b7b1]:
   [
   In( message ), !Agent_Compromised( $Agent ),
   New_Server_TLS_Session( $Agent, ~tls_session_id )
   ]
  --[ Adversary_Sends_as_Server( $Agent, ~tls_session_id, message ) ]->
   [ Out( https_response(~tls_session_id, message) ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Generate_New_Id:
   [ Fr( ~id ) ] --[ Generate_New_Id( ~id ) ]-> [ New_Id( ~id ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) SP_Resource_Request[color=#e0ffff]:
   [
   !SP_Initialized( $SP ), !Is_Resource( $url, $SP ),
   !Is_Registered( $SP, $IdP ), !Ltk( $SP, ~ltkSP ),
   New_Server_TLS_Session( $SP, ~tls_session_id_C_SP ),
   In( https_request($SP, ~tls_session_id_C_SP, <'ResourceRequest', $url>)
   ),
   New_Id( ~id_authnrequest ), Fr( ~rs )
   ]
  --[
  Start_SP( $SP ),
  SP_Resource_Request( $SP, $IdP, ~id_authnrequest, $url ),
  Https_Response( https_response(~tls_session_id_C_SP,
                                 <$IdP, $url, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                                  sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)>)
  )
  ]->
   [
   SP_State_1( $SP, $IdP, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>,
               'NoRelayState'
   ),
   Out( https_response(~tls_session_id_C_SP,
                       <$IdP, $url, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                        sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)>)
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) SP_Resource_Request_With_Artifact[color=#e0ffff]:
   [
   SP_State_1( $SP, $IdP, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>,
               'NoRelayState'
   ),
   !Ltk( $SP, ~ltkSP ), !Is_Resource( $url, $SP ),
   New_Id( ~id_artifactresolve ),
   New_Server_TLS_Session( $SP, ~client_ID_TLS_C_SP ),
   In( https_request($SP, ~client_ID_TLS_C_SP,
                     <<'Artifact', $IdP, ~messageHandle, ~id_authnrequest>, $url>)
   ),
   New_Client_TLS_Session( $SP, $IdP, ~client_ID_TLS_SP_IdP )
   ]
  --[
  SP_Resource_Request_With_Artifact( $SP, $IdP, ~id_authnrequest,
                                     ~messageHandle
  ),
  SP_Signs_ArtifactResolve( $SP,
                            <'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                             ~messageHandle, ~id_authnrequest>
  ),
  Https_Request( https_request($IdP, ~client_ID_TLS_SP_IdP,
                               <
                                <'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                                 ~messageHandle, ~id_authnrequest>, 
                                sign(<'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                                      ~messageHandle, ~id_authnrequest>,
                                     ~ltkSP)
                               >)
  )
  ]->
   [
   SP_State_2( $SP, $IdP, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>,
               $url,
               <'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                ~messageHandle, ~id_authnrequest>,
               ~client_ID_TLS_C_SP, ~client_ID_TLS_SP_IdP
   ),
   Out( https_request($IdP, ~client_ID_TLS_SP_IdP,
                      <
                       <'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                        ~messageHandle, ~id_authnrequest>, 
                       sign(<'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                             ~messageHandle, ~id_authnrequest>,
                            ~ltkSP)
                      >)
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) SP_Artifact_Resolution[color=#e0ffff]:
   [
   SP_State_2( $SP, $IdP, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>,
               $url,
               <'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                ~messageHandle, ~id_authnrequest>,
               ~client_ID_TLS_C_SP, ~client_ID_TLS_SP_IdP
   ),
   !Ltk( $IdP, ~ltkIdP ),
   !Client_Has_Resource( $SP, ~clientID, $url, ~res ), Fr( ~ts_res ),
   In( https_response(~client_ID_TLS_SP_IdP,
                      <
                       <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                        <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                         ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                         <'Audience', $SP>, ~assertion_secret>, 
                        ResponseSignature>, 
                       sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                             <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                              ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                              <'Audience', $SP>, ~assertion_secret>, 
                             ResponseSignature>,
                            ~ltkIdP)
                      >)
   )
   ]
  --[
  SP_Params_Client( $SP, $IdP, ~clientID, <~res, $url, ~ts_res>,
                    ~id_authnrequest
  ),
  SP_Params_IdP( $SP, $IdP, ~clientID, ~id_authnrequest, ~messageHandle,
                 ~id_artifactresolve
  ),
  SP_Assertion_Secret( $SP, $IdP, ~assertion_secret ),
  SPFinish( $SP, $C, $IdP ),
  Https_Response( https_response(~client_ID_TLS_C_SP,
                                 <~res, $url, ~ts_res>)
  )
  ]->
   [ Out( https_response(~client_ID_TLS_C_SP, <~res, $url, ~ts_res>) ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) IdP_Receive_Authentication_Request[color=#fafad2]:
   [
   !IdP_Initialized( $IdP ), !Is_Registered( $SP, $IdP ),
   !Ltk( $SP, ~ltkSP ),
   New_Server_TLS_Session( $IdP, ~tls_session_id_C_IdP ),
   Fr( ~auth_session ),
   In( https_request($IdP, ~tls_session_id_C_IdP,
                     <$IdP, $url, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                      sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)>)
   )
   ]
  --[
  Start_IdP( $IdP ),
  Https_Response( https_response(~tls_session_id_C_IdP,
                                 <'PlsAuthAndConsent', $SP, $IdP, ~auth_session>)
  )
  ]->
   [
   IdP_State_1( $IdP, $url, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>,
                ~auth_session
   ),
   Out( https_response(~tls_session_id_C_IdP,
                       <'PlsAuthAndConsent', $SP, $IdP, ~auth_session>)
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) IdP_Client_Authentication[color=#fafad2]:
   [
   IdP_State_1( $IdP, $url, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>,
                ~auth_session
   ),
   !Client_Registered_at_IdP( $IdP, ~clientID, ~clientSecret ),
   Fr( ~messageHandle ),
   New_Server_TLS_Session( $IdP, ~client_ID_TLS_C_IdP ),
   In( https_request($IdP, ~client_ID_TLS_C_IdP,
                     <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret, ~auth_session>)
   )
   ]
  --[
  IdP_Client_Authentication( $IdP, ~clientID,
                             <'AuthnRequest', ~id_authnrequest, $SP, $IdP>
  ),
  Https_Response( https_response(~client_ID_TLS_C_IdP,
                                 <<'Artifact', $IdP, ~messageHandle, ~id_authnrequest>, $url>)
  )
  ]->
   [
   IdP_State_2( $IdP, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>,
                <'Artifact', $IdP, ~messageHandle, ~id_authnrequest>, ~clientID
   ),
   Out( https_response(~client_ID_TLS_C_IdP,
                       <<'Artifact', $IdP, ~messageHandle, ~id_authnrequest>, $url>)
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) IdP_Artifact_Resolution[color=#fafad2]:
   [
   IdP_State_2( $IdP, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>,
                <'Artifact', $IdP, ~messageHandle, ~id_authnrequest>, ~clientID
   ),
   !Ltk( $SP, ~ltkSP ), !Ltk( $IdP, ~ltkIdP ),
   !Client_Registered_at_IdP( $IdP, ~clientID, ~clientSecret ),
   New_Server_TLS_Session( $IdP, ~client_ID_TLS_SP_IdP ),
   In( https_request($IdP, ~client_ID_TLS_SP_IdP,
                     <
                      <'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                       ~messageHandle, ~id_authnrequest>, 
                      sign(<'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                            ~messageHandle, ~id_authnrequest>,
                           ~ltkSP)
                     >)
   ),
   Fr( ~assertion_secret ), New_Id( ~id_assertion ), New_Id( ~id_response )
   ]
  --[
  IDPFinish( $C, $SP, $IdP ),
  IdP_Params( $IdP, $SP, ~clientID, ~id_authnrequest, ~messageHandle,
              ~id_artifactresolve
  ),
  IdP_Assertion_Secret( $IdP, $SP, ~assertion_secret ),
  Https_Response( https_response(~client_ID_TLS_SP_IdP,
                                 <
                                  <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                   <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                    ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                    <'Audience', $SP>, ~assertion_secret>, 
                                   sign(<'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                         ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                         <'Audience', $SP>, ~assertion_secret>,
                                        ~ltkIdP)
                                  >, 
                                  sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                        <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                         ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                         <'Audience', $SP>, ~assertion_secret>, 
                                        sign(<'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                              ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                              <'Audience', $SP>, ~assertion_secret>,
                                             ~ltkIdP)
                                       >,
                                       ~ltkIdP)
                                 >)
  )
  ]->
   [
   Out( https_response(~client_ID_TLS_SP_IdP,
                       <
                        <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                         <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                          ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                          <'Audience', $SP>, ~assertion_secret>, 
                         sign(<'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                               ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                               <'Audience', $SP>, ~assertion_secret>,
                              ~ltkIdP)
                        >, 
                        sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                              <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                               ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                               <'Audience', $SP>, ~assertion_secret>, 
                              sign(<'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                    ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                    <'Audience', $SP>, ~assertion_secret>,
                                   ~ltkIdP)
                             >,
                             ~ltkIdP)
                       >)
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Client_Resource_Request[color=#add8e6]:
   [
   !Client_Initialized( $C ), !Is_Resource( $url, $SP1 ),
   Fr( ~client_session_id ),
   New_Client_TLS_Session( $C, $SP, ~tls_session_id_C_SP )
   ]
  --[
  Start_Client( $C ),
  Client_Resource_Request( $C, $SP, ~client_session_id, $url ),
  Https_Request( https_request($SP, ~tls_session_id_C_SP,
                               <'ResourceRequest', $url>)
  )
  ]->
   [
   Client_State_1( $C, $SP, ~client_session_id, ~tls_session_id_C_SP ),
   Out( https_request($SP, ~tls_session_id_C_SP, <'ResourceRequest', $url>)
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Client_AuthnRequest_Redirect[color=#add8e6]:
   [
   Client_State_1( $C, $SP, ~client_session_id, ~tls_session_id_C_SP ),
   !Ltk( $SP1, ~ltkSP1 ),
   In( https_response(~tls_session_id_C_SP,
                      <$IdP, $url, <'AuthnRequest', ~id_authnrequest, $SP1, $IdP1>, 
                       sign(<'AuthnRequest', ~id_authnrequest, $SP1, $IdP1>, ~ltkSP1)>)
   ),
   New_Client_TLS_Session( $C, $IdP, ~tls_session_id_C_IdP )
   ]
  --[
  Https_Request( https_request($IdP, ~tls_session_id_C_IdP,
                               <$IdP, $url, <'AuthnRequest', ~id_authnrequest, $SP1, $IdP1>, 
                                sign(<'AuthnRequest', ~id_authnrequest, $SP1, $IdP1>, ~ltkSP1)>)
  )
  ]->
   [
   Client_State_2( $C, $SP, $IdP, ~client_session_id, ~tls_session_id_C_IdP
   ),
   Out( https_request($IdP, ~tls_session_id_C_IdP,
                      <$IdP, $url, <'AuthnRequest', ~id_authnrequest, $SP1, $IdP1>, 
                       sign(<'AuthnRequest', ~id_authnrequest, $SP1, $IdP1>, ~ltkSP1)>)
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Client_Authentication_at_IdP[color=#add8e6]:
   [
   Client_State_2( $C, $SP, $IdP, ~client_session_id, ~tls_session_id_C_IdP
   ),
   !ClientID( $C, ~clientID ),
   !Client_Registered_at_IdP( $IdP, ~clientID, ~clientSecret ),
   In( https_response(~tls_session_id_C_IdP,
                      <'PlsAuthAndConsent', $SP, $IdP, ~auth_session>)
   ),
   New_Client_TLS_Session( $C, $IdP, ~tls_session_id_C_IdP_1 )
   ]
  --[
  Https_Request( https_request($IdP, ~tls_session_id_C_IdP_1,
                               <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret, ~auth_session>)
  )
  ]->
   [
   Client_State_3( $C, $SP, $IdP, ~client_session_id,
                   ~tls_session_id_C_IdP_1
   ),
   Out( https_request($IdP, ~tls_session_id_C_IdP_1,
                      <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret, ~auth_session>)
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Client_Artifact_Redirect[color=#add8e6]:
   [
   Client_State_3( $C, $SP, $IdP, ~client_session_id, ~tls_session_id_C_IdP
   ),
   In( https_response(~tls_session_id_C_IdP,
                      <<'Artifact', $Agent, ~messageHandle>, $url>)
   ),
   New_Client_TLS_Session( $C, $SP, ~tls_session_id_C_SP )
   ]
  --[
  Client_Artifact_Redirect( $C, $SP, $IdP, ~client_session_id, $Agent ),
  Https_Request( https_request($SP, ~tls_session_id_C_SP,
                               <<'Artifact', $Agent, ~messageHandle>, $url>)
  )
  ]->
   [
   Client_State_4( $C, $SP, $IdP, ~client_session_id, ~tls_session_id_C_SP
   ),
   Out( https_request($SP, ~tls_session_id_C_SP,
                      <<'Artifact', $Agent, ~messageHandle>, $url>)
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Client_Receive_Resource[color=#add8e6]:
   [
   Client_State_4( $C, $SP, $IdP, ~client_session_id, ~tls_session_id_C_SP
   ),
   In( https_response(~tls_session_id_C_SP, <~res, $url, ~ts_res>) ),
   !ClientID( $C, ~clientID )
   ]
  --[
  ClientFinish( $C, $SP, $IdP ),
  Client_Params( $C, $SP, $IdP, ~clientID, ~client_session_id,
                 <~res, $url, ~ts_res>
  )
  ]->
   [ ]

  /* has exactly the trivial AC variant */

restriction Agent_Initializes_Once:
  "∀ A #i #j.
    ((Initialize_Agent( A ) @ #i) ∧ (Initialize_Agent( A ) @ #j)) ⇒
    (#i = #j)"
  // safety formula

restriction No_Corrupt_to_Corrupt_TLS:
  "∀ C S id #i #j #k.
    (((Client_Starts_TLS( C, S, id ) @ #i) ∧ (Compromise_Agent( C ) @ #j)) ∧
     (Compromise_Agent( S ) @ #k)) ⇒
    (⊥)"
  // safety formula

restriction No_Client_Sessions:
  "∀ A #i. (Start_Client( A ) @ #i) ⇒ (⊥)"
  // safety formula

lemma https_typing [sources]:
  all-traces
  "(∀ m #i.
     (Adversary_Receives_as_Client( m ) @ #i) ⇒
     (∃ #j. (Https_Response( m ) @ #j) ∧ (#j < #i))) ∧
   (∀ m #i.
     (Adversary_Receives_as_Server( m ) @ #i) ⇒
     (∃ #j. (Https_Request( m ) @ #j) ∧ (#j < #i)))"
/*
guarded formula characterizing all counter-examples:
"((∃ m #i.
    (Adversary_Receives_as_Client( m ) @ #i)
   ∧
    ∀ #j. (Https_Response( m ) @ #j) ⇒ ¬(#j < #i)) ∨
  (∃ m #i.
    (Adversary_Receives_as_Server( m ) @ #i)
   ∧
    ∀ #j. (Https_Request( m ) @ #j) ⇒ ¬(#j < #i)))"
*/
by sorry

lemma helper_Either_Honest_or_Compromised_Client [reuse]:
  all-traces
  "∀ A #i #j.
    ((Compromise_Agent( A ) @ #i) ∧ (Initialize_Client( A ) @ #j)) ⇒ (⊥)"
/*
guarded formula characterizing all counter-examples:
"∃ A #i #j. (Compromise_Agent( A ) @ #i) ∧ (Initialize_Client( A ) @ #j)"
*/
by sorry

lemma helper_Either_Honest_or_Compromised_SP [reuse]:
  all-traces
  "∀ A #i #j.
    ((Compromise_Agent( A ) @ #i) ∧ (Initialize_SP( A ) @ #j)) ⇒ (⊥)"
/*
guarded formula characterizing all counter-examples:
"∃ A #i #j. (Compromise_Agent( A ) @ #i) ∧ (Initialize_SP( A ) @ #j)"
*/
by sorry

lemma helper_Either_Honest_or_Compromised_IdP [reuse]:
  all-traces
  "∀ A #i #j.
    ((Compromise_Agent( A ) @ #i) ∧ (Initialize_IdP( A ) @ #j)) ⇒ (⊥)"
/*
guarded formula characterizing all counter-examples:
"∃ A #i #j. (Compromise_Agent( A ) @ #i) ∧ (Initialize_IdP( A ) @ #j)"
*/
by sorry

lemma helper_tls_Sends_as_Server_Only_if_Compromised [reuse]:
  all-traces
  "∀ A id m #i.
    (Adversary_Sends_as_Server( A, id, m ) @ #i) ⇒
    (∃ #j. Compromise_Agent( A ) @ #j)"
/*
guarded formula characterizing all counter-examples:
"∃ A id m #i.
  (Adversary_Sends_as_Server( A, id, m ) @ #i)
 ∧
  ∀ #j. (Compromise_Agent( A ) @ #j) ⇒ ⊥"
*/
by sorry

lemma helper_tls_Cannot_Send_As_Honest_Server_2 [reuse]:
  all-traces
  "∀ A C S id m #i #j.
    ((Adversary_Sends_as_Server( A, id, m ) @ #i) ∧
     (Client_Starts_TLS( C, S, id ) @ #j)) ⇒
    (∃ #k. Compromise_Agent( S ) @ #k)"
/*
guarded formula characterizing all counter-examples:
"∃ A C S id m #i #j.
  (Adversary_Sends_as_Server( A, id, m ) @ #i) ∧
  (Client_Starts_TLS( C, S, id ) @ #j)
 ∧
  ∀ #k. (Compromise_Agent( S ) @ #k) ⇒ ⊥"
*/
by sorry

lemma helper_tls_Session_Id_Secrecy [reuse]:
  all-traces
  "∀ C S id #i.
    (Client_Starts_TLS( C, S, id ) @ #i) ⇒ (¬(∃ #j. !KU( id ) @ #j))"
/*
guarded formula characterizing all counter-examples:
"∃ C S id #i.
  (Client_Starts_TLS( C, S, id ) @ #i) ∧ ∃ #j. (!KU( id ) @ #j)"
*/
by sorry

lemma helper_Long_Term_Key_Secrecy [reuse]:
  all-traces
  "∀ A ltk #i #k.
    ((Agent_Key( A, ltk ) @ #i) ∧ (!KU( ltk ) @ #k)) ⇒
    (∃ #j. Compromise_Agent( A ) @ #j)"
/*
guarded formula characterizing all counter-examples:
"∃ A ltk #i #k.
  (Agent_Key( A, ltk ) @ #i) ∧ (!KU( ltk ) @ #k)
 ∧
  ∀ #j. (Compromise_Agent( A ) @ #j) ⇒ ⊥"
*/
by sorry

lemma helper_Client_Secret_Secrecy [reuse]:
  all-traces
  "∀ C I id s #i #k.
    ((Register_Client_at_IdP( C, I, id, s ) @ #i) ∧ (!KU( s ) @ #k)) ⇒ (⊥)"
/*
guarded formula characterizing all counter-examples:
"∃ C I id s #i #k.
  (Register_Client_at_IdP( C, I, id, s ) @ #i) ∧ (!KU( s ) @ #k)"
*/
by sorry

lemma sec_Client_Resource_Authenticity:
  all-traces
  "∀ C S I cid csid url res ts #i.
    (Client_Params( C, S, I, cid, csid, <res, url, ts> ) @ #i) ⇒
    (((∃ #j. Register_Resource_at_SP( C, S, cid, res, url ) @ #j) ∨
      (∃ #j. Compromise_Agent( S ) @ #j)) ∨
     (∃ I.1 #j #k.
       (Compromise_Agent( I.1 ) @ #j) ∧ (Register_SP_at_IdP( S, I.1 ) @ #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ C S I cid csid url res ts #i.
  (Client_Params( C, S, I, cid, csid, <res, url, ts> ) @ #i)
 ∧
  (∀ #j. (Register_Resource_at_SP( C, S, cid, res, url ) @ #j) ⇒ ⊥) ∧
  (∀ #j. (Compromise_Agent( S ) @ #j) ⇒ ⊥) ∧
  (∀ I.1 #j #k.
    (Compromise_Agent( I.1 ) @ #j) ∧ (Register_SP_at_IdP( S, I.1 ) @ #k)
   ⇒
    ⊥)"
*/
by sorry

lemma sec_Client_Resource_Authenticity_Strong:
  all-traces
  "∀ C S I cid csid url res ts #i.
    (Client_Params( C, S, I, cid, csid, <res, url, ts> ) @ #i) ⇒
    (((∃ #j. Register_Resource_at_SP( C, S, cid, res, url ) @ #j) ∨
      (∃ #j. Compromise_Agent( S ) @ #j)) ∨
     (∃ #j. Compromise_Agent( I ) @ #j))"
/*
guarded formula characterizing all counter-examples:
"∃ C S I cid csid url res ts #i.
  (Client_Params( C, S, I, cid, csid, <res, url, ts> ) @ #i)
 ∧
  (∀ #j. (Register_Resource_at_SP( C, S, cid, res, url ) @ #j) ⇒ ⊥) ∧
  (∀ #j. (Compromise_Agent( S ) @ #j) ⇒ ⊥) ∧
  (∀ #j. (Compromise_Agent( I ) @ #j) ⇒ ⊥)"
*/
by sorry

lemma sec_Client_Registered_Resource_Secrecy:
  all-traces
  "∀ C S url res id #i.
    (Register_Resource_at_SP( C, S, id, res, url ) @ #i) ⇒
    (((¬(∃ #j. K( res ) @ #j)) ∨ (∃ #j. Compromise_Agent( S ) @ #j)) ∨
     (∃ I #j #k.
       (Compromise_Agent( I ) @ #j) ∧ (Register_SP_at_IdP( S, I ) @ #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ C S url res id #i.
  (Register_Resource_at_SP( C, S, id, res, url ) @ #i)
 ∧
  (∃ #j. (K( res ) @ #j)) ∧
  (∀ #j. (Compromise_Agent( S ) @ #j) ⇒ ⊥) ∧
  (∀ I #j #k.
    (Compromise_Agent( I ) @ #j) ∧ (Register_SP_at_IdP( S, I ) @ #k) ⇒ ⊥)"
*/
by sorry

lemma sec_Client_Registered_Resource_Secrecy_Strong:
  all-traces
  "∀ C S url res id #i.
    (Register_Resource_at_SP( C, S, id, res, url ) @ #i) ⇒
    ((¬(∃ #j. K( res ) @ #j)) ∨ (∃ #j. Compromise_Agent( S ) @ #j))"
/*
guarded formula characterizing all counter-examples:
"∃ C S url res id #i.
  (Register_Resource_at_SP( C, S, id, res, url ) @ #i)
 ∧
  (∃ #j. (K( res ) @ #j)) ∧ (∀ #j. (Compromise_Agent( S ) @ #j) ⇒ ⊥)"
*/
by sorry

lemma sec_Client_Resource_Secrecy:
  all-traces
  "∀ C S I cid csid url res ts #i.
    (Client_Params( C, S, I, cid, csid, <res, url, ts> ) @ #i) ⇒
    (((¬(∃ #j. K( ts ) @ #j)) ∨ (∃ #j. Compromise_Agent( S ) @ #j)) ∨
     (∃ I.1 #j #k.
       (Compromise_Agent( I.1 ) @ #j) ∧ (Register_SP_at_IdP( S, I.1 ) @ #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ C S I cid csid url res ts #i.
  (Client_Params( C, S, I, cid, csid, <res, url, ts> ) @ #i)
 ∧
  (∃ #j. (K( ts ) @ #j)) ∧
  (∀ #j. (Compromise_Agent( S ) @ #j) ⇒ ⊥) ∧
  (∀ I.1 #j #k.
    (Compromise_Agent( I.1 ) @ #j) ∧ (Register_SP_at_IdP( S, I.1 ) @ #k)
   ⇒
    ⊥)"
*/
by sorry

lemma sec_Client_Resource_Secrecy_Strong:
  all-traces
  "∀ C S I cid csid url res ts #i.
    (Client_Params( C, S, I, cid, csid, <res, url, ts> ) @ #i) ⇒
    (((¬(∃ #j. K( ts ) @ #j)) ∨ (∃ #j. Compromise_Agent( S ) @ #j)) ∨
     (∃ #j. Compromise_Agent( I ) @ #j))"
/*
guarded formula characterizing all counter-examples:
"∃ C S I cid csid url res ts #i.
  (Client_Params( C, S, I, cid, csid, <res, url, ts> ) @ #i)
 ∧
  (∃ #j. (K( ts ) @ #j)) ∧
  (∀ #j. (Compromise_Agent( S ) @ #j) ⇒ ⊥) ∧
  (∀ #j. (Compromise_Agent( I ) @ #j) ⇒ ⊥)"
*/
by sorry

lemma sec_Client_Resource_Freshness:
  all-traces
  "∀ C S I A cid csid url res ts #i #j.
    ((Client_Artifact_Redirect( C, S, I, csid, A ) @ #i) ∧
     (Client_Params( C, S, I, cid, csid, <res, url, ts> ) @ #j)) ⇒
    ((∃ I1 cid1 ida #k.
       ((SP_Params_Client( S, I1, cid1, <res, url, ts>, ida ) @ #k) ∧
        (#i < #k)) ∧
       (#k < #j)) ∨
     (∃ #k. Compromise_Agent( S ) @ #k))"
/*
guarded formula characterizing all counter-examples:
"∃ C S I A cid csid url res ts #i #j.
  (Client_Artifact_Redirect( C, S, I, csid, A ) @ #i) ∧
  (Client_Params( C, S, I, cid, csid, <res, url, ts> ) @ #j)
 ∧
  (∀ I1 cid1 ida #k.
    (SP_Params_Client( S, I1, cid1, <res, url, ts>, ida ) @ #k)
   ⇒
    ((¬(#i < #k)) ∨ (¬(#k < #j)))) ∧
  (∀ #k. (Compromise_Agent( S ) @ #k) ⇒ ⊥)"
*/
by sorry

lemma sec_Client_SP_Non_Injective_Agreement:
  all-traces
  "∀ C S I cid csid url res ts #i.
    (Client_Params( C, S, I, cid, csid, <res, url, ts> ) @ #i) ⇒
    (((∃ #k ida. SP_Params_Client( S, I, cid, <res, url, ts>, ida ) @ #k) ∨
      (∃ #j. Compromise_Agent( S ) @ #j)) ∨
     (∃ I.1 #j #k.
       (Compromise_Agent( I.1 ) @ #j) ∧ (Register_SP_at_IdP( S, I.1 ) @ #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ C S I cid csid url res ts #i.
  (Client_Params( C, S, I, cid, csid, <res, url, ts> ) @ #i)
 ∧
  (∀ #k ida.
    (SP_Params_Client( S, I, cid, <res, url, ts>, ida ) @ #k) ⇒ ⊥) ∧
  (∀ #j. (Compromise_Agent( S ) @ #j) ⇒ ⊥) ∧
  (∀ I.1 #j #k.
    (Compromise_Agent( I.1 ) @ #j) ∧ (Register_SP_at_IdP( S, I.1 ) @ #k)
   ⇒
    ⊥)"
*/
by sorry

lemma sec_Client_SP_Non_Injective_Agreement_Strong:
  all-traces
  "∀ C S I cid csid url res ts #i.
    (Client_Params( C, S, I, cid, csid, <res, url, ts> ) @ #i) ⇒
    (((∃ #k ida. SP_Params_Client( S, I, cid, <res, url, ts>, ida ) @ #k) ∨
      (∃ #j. Compromise_Agent( S ) @ #j)) ∨
     (∃ #j. Compromise_Agent( I ) @ #j))"
/*
guarded formula characterizing all counter-examples:
"∃ C S I cid csid url res ts #i.
  (Client_Params( C, S, I, cid, csid, <res, url, ts> ) @ #i)
 ∧
  (∀ #k ida.
    (SP_Params_Client( S, I, cid, <res, url, ts>, ida ) @ #k) ⇒ ⊥) ∧
  (∀ #j. (Compromise_Agent( S ) @ #j) ⇒ ⊥) ∧
  (∀ #j. (Compromise_Agent( I ) @ #j) ⇒ ⊥)"
*/
by sorry

lemma sec_Client_SP_Injective_Agreement:
  all-traces
  "∀ C S I cid csid url res ts #i.
    (Client_Params( C, S, I, cid, csid, <res, url, ts> ) @ #i) ⇒
    (((∃ #k ida.
        (SP_Params_Client( S, I, cid, <res, url, ts>, ida ) @ #k) ∧
        (¬(∃ csid1 I1 #i1.
            (Client_Params( C, S, I1, cid, csid1, <res, url, ts> ) @ #i1) ∧
            (¬(#i = #i1))))) ∨
      (∃ #j. Compromise_Agent( S ) @ #j)) ∨
     (∃ I.1 #j #k.
       (Compromise_Agent( I.1 ) @ #j) ∧ (Register_SP_at_IdP( S, I.1 ) @ #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ C S I cid csid url res ts #i.
  (Client_Params( C, S, I, cid, csid, <res, url, ts> ) @ #i)
 ∧
  (∀ #k ida.
    (SP_Params_Client( S, I, cid, <res, url, ts>, ida ) @ #k)
   ⇒
    ∃ csid1 I1 #i1.
     (Client_Params( C, S, I1, cid, csid1, <res, url, ts> ) @ #i1)
    ∧
     ¬(#i = #i1)) ∧
  (∀ #j. (Compromise_Agent( S ) @ #j) ⇒ ⊥) ∧
  (∀ I.1 #j #k.
    (Compromise_Agent( I.1 ) @ #j) ∧ (Register_SP_at_IdP( S, I.1 ) @ #k)
   ⇒
    ⊥)"
*/
by sorry

lemma sec_Client_SP_Injective_Agreement_Strong:
  all-traces
  "∀ C S I cid csid url res ts #i.
    (Client_Params( C, S, I, cid, csid, <res, url, ts> ) @ #i) ⇒
    (((∃ #k ida.
        (SP_Params_Client( S, I, cid, <res, url, ts>, ida ) @ #k) ∧
        (¬(∃ csid1 I1 #i1.
            (Client_Params( C, S, I1, cid, csid1, <res, url, ts> ) @ #i1) ∧
            (¬(#i = #i1))))) ∨
      (∃ #j. Compromise_Agent( S ) @ #j)) ∨
     (∃ #j. Compromise_Agent( I ) @ #j))"
/*
guarded formula characterizing all counter-examples:
"∃ C S I cid csid url res ts #i.
  (Client_Params( C, S, I, cid, csid, <res, url, ts> ) @ #i)
 ∧
  (∀ #k ida.
    (SP_Params_Client( S, I, cid, <res, url, ts>, ida ) @ #k)
   ⇒
    ∃ csid1 I1 #i1.
     (Client_Params( C, S, I1, cid, csid1, <res, url, ts> ) @ #i1)
    ∧
     ¬(#i = #i1)) ∧
  (∀ #j. (Compromise_Agent( S ) @ #j) ⇒ ⊥) ∧
  (∀ #j. (Compromise_Agent( I ) @ #j) ⇒ ⊥)"
*/
by sorry

lemma sec_SP_Client_Resource_Secrecy:
  all-traces
  "∀ S I url res cid ts ida #i.
    (SP_Params_Client( S, I, cid, <res, url, ts>, ida ) @ #i) ⇒
    (((¬(∃ #k. K( ts ) @ #k)) ∨
      (∃ C #k #l. (Compromise_Agent( C ) @ #k) ∧ (Agent_ID( C, cid ) @ #l))) ∨
     (∃ I.1 #k #l.
       (Compromise_Agent( I.1 ) @ #k) ∧ (Register_SP_at_IdP( S, I.1 ) @ #l)))"
/*
guarded formula characterizing all counter-examples:
"∃ S I url res cid ts ida #i.
  (SP_Params_Client( S, I, cid, <res, url, ts>, ida ) @ #i)
 ∧
  (∃ #k. (K( ts ) @ #k)) ∧
  (∀ C #k #l.
    (Compromise_Agent( C ) @ #k) ∧ (Agent_ID( C, cid ) @ #l) ⇒ ⊥) ∧
  (∀ I.1 #k #l.
    (Compromise_Agent( I.1 ) @ #k) ∧ (Register_SP_at_IdP( S, I.1 ) @ #l)
   ⇒
    ⊥)"
*/
by sorry

lemma sec_SP_Client_Resource_Secrecy_Strong:
  all-traces
  "∀ S I url res cid ts ida #i.
    (SP_Params_Client( S, I, cid, <res, url, ts>, ida ) @ #i) ⇒
    (((¬(∃ #k. K( ts ) @ #k)) ∨
      (∃ C #k #l. (Compromise_Agent( C ) @ #k) ∧ (Agent_ID( C, cid ) @ #l))) ∨
     (∃ #k. Compromise_Agent( I ) @ #k))"
/*
guarded formula characterizing all counter-examples:
"∃ S I url res cid ts ida #i.
  (SP_Params_Client( S, I, cid, <res, url, ts>, ida ) @ #i)
 ∧
  (∃ #k. (K( ts ) @ #k)) ∧
  (∀ C #k #l.
    (Compromise_Agent( C ) @ #k) ∧ (Agent_ID( C, cid ) @ #l) ⇒ ⊥) ∧
  (∀ #k. (Compromise_Agent( I ) @ #k) ⇒ ⊥)"
*/
by sorry

lemma sec_SP_Client_Non_Injective_Agreement:
  all-traces
  "∀ C S I url res cid ts ida #i #j.
    ((SP_Params_Client( S, I, cid, <res, url, ts>, ida ) @ #i) ∧
     (Agent_ID( C, cid ) @ #j)) ⇒
    (((∃ csid #k #l.
        (Client_Resource_Request( C, S, csid, url ) @ #k) ∧
        (Client_Artifact_Redirect( C, S, I, csid, I ) @ #l)) ∨
      (∃ #k. Compromise_Agent( C ) @ #k)) ∨
     (∃ I.1 #k #l.
       (Compromise_Agent( I.1 ) @ #k) ∧ (Register_SP_at_IdP( S, I.1 ) @ #l)))"
/*
guarded formula characterizing all counter-examples:
"∃ C S I url res cid ts ida #i #j.
  (SP_Params_Client( S, I, cid, <res, url, ts>, ida ) @ #i) ∧
  (Agent_ID( C, cid ) @ #j)
 ∧
  (∀ csid #k #l.
    (Client_Resource_Request( C, S, csid, url ) @ #k) ∧
    (Client_Artifact_Redirect( C, S, I, csid, I ) @ #l)
   ⇒
    ⊥) ∧
  (∀ #k. (Compromise_Agent( C ) @ #k) ⇒ ⊥) ∧
  (∀ I.1 #k #l.
    (Compromise_Agent( I.1 ) @ #k) ∧ (Register_SP_at_IdP( S, I.1 ) @ #l)
   ⇒
    ⊥)"
*/
by sorry

lemma sec_SP_Client_Non_Injective_Agreement_Strong:
  all-traces
  "∀ C S I url res cid ts ida #i #j.
    ((SP_Params_Client( S, I, cid, <res, url, ts>, ida ) @ #i) ∧
     (Agent_ID( C, cid ) @ #j)) ⇒
    (((∃ csid #k #l.
        (Client_Resource_Request( C, S, csid, url ) @ #k) ∧
        (Client_Artifact_Redirect( C, S, I, csid, I ) @ #l)) ∨
      (∃ #k. Compromise_Agent( C ) @ #k)) ∨
     (∃ #k. Compromise_Agent( I ) @ #k))"
/*
guarded formula characterizing all counter-examples:
"∃ C S I url res cid ts ida #i #j.
  (SP_Params_Client( S, I, cid, <res, url, ts>, ida ) @ #i) ∧
  (Agent_ID( C, cid ) @ #j)
 ∧
  (∀ csid #k #l.
    (Client_Resource_Request( C, S, csid, url ) @ #k) ∧
    (Client_Artifact_Redirect( C, S, I, csid, I ) @ #l)
   ⇒
    ⊥) ∧
  (∀ #k. (Compromise_Agent( C ) @ #k) ⇒ ⊥) ∧
  (∀ #k. (Compromise_Agent( I ) @ #k) ⇒ ⊥)"
*/
by sorry

lemma sec_SP_IdP_Weak_Agreement:
  all-traces
  "∀ S I cid ida mh idr #i.
    (SP_Params_IdP( S, I, cid, ida, mh, idr ) @ #i) ⇒
    ((∃ S1 ida1 mh1 idr1 #j.
       IdP_Params( I, S1, cid, ida1, mh1, idr1 ) @ #j) ∨
     (∃ I.1 #j #k.
       (Compromise_Agent( I.1 ) @ #j) ∧ (Register_SP_at_IdP( S, I.1 ) @ #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ S I cid ida mh idr #i.
  (SP_Params_IdP( S, I, cid, ida, mh, idr ) @ #i)
 ∧
  (∀ S1 ida1 mh1 idr1 #j.
    (IdP_Params( I, S1, cid, ida1, mh1, idr1 ) @ #j) ⇒ ⊥) ∧
  (∀ I.1 #j #k.
    (Compromise_Agent( I.1 ) @ #j) ∧ (Register_SP_at_IdP( S, I.1 ) @ #k)
   ⇒
    ⊥)"
*/
simplify
solve( SP_State_2( $SP, $IdP,
                   <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, $url,
                   <'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                    ~messageHandle, ~id_authnrequest>,
                   ~client_ID_TLS_C_SP, ~client_ID_TLS_SP_IdP
       ) ▶₀ #i )
  case SP_Resource_Request_With_Artifact_case_1
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_2
    by contradiction /* from formulas */
  qed
next
  case SP_Resource_Request_With_Artifact_case_2
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_2
    by contradiction /* from formulas */
  qed
next
  case SP_Resource_Request_With_Artifact_case_3
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_2
    by contradiction /* from formulas */
  qed
next
  case SP_Resource_Request_With_Artifact_case_4
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_2
    by contradiction /* from formulas */
  qed
qed

lemma sec_SP_IdP_Weak_Agreement_Strong:
  all-traces
  "∀ S I cid ida mh idr #i.
    (SP_Params_IdP( S, I, cid, ida, mh, idr ) @ #i) ⇒
    ((∃ S1 ida1 mh1 idr1 #j.
       IdP_Params( I, S1, cid, ida1, mh1, idr1 ) @ #j) ∨
     (∃ #j. Compromise_Agent( I ) @ #j))"
/*
guarded formula characterizing all counter-examples:
"∃ S I cid ida mh idr #i.
  (SP_Params_IdP( S, I, cid, ida, mh, idr ) @ #i)
 ∧
  (∀ S1 ida1 mh1 idr1 #j.
    (IdP_Params( I, S1, cid, ida1, mh1, idr1 ) @ #j) ⇒ ⊥) ∧
  (∀ #j. (Compromise_Agent( I ) @ #j) ⇒ ⊥)"
*/
simplify
solve( SP_State_2( $SP, $IdP,
                   <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, $url,
                   <'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                    ~messageHandle, ~id_authnrequest>,
                   ~client_ID_TLS_C_SP, ~client_ID_TLS_SP_IdP
       ) ▶₀ #i )
  case SP_Resource_Request_With_Artifact_case_1
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_2
    by contradiction /* from formulas */
  qed
next
  case SP_Resource_Request_With_Artifact_case_2
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_2
    by contradiction /* from formulas */
  qed
next
  case SP_Resource_Request_With_Artifact_case_3
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_2
    by contradiction /* from formulas */
  qed
next
  case SP_Resource_Request_With_Artifact_case_4
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_2
    by contradiction /* from formulas */
  qed
qed

lemma sec_SP_IdP_Non_Injective_Agreement:
  all-traces
  "∀ S I cid ida mh idr #i.
    (SP_Params_IdP( S, I, cid, ida, mh, idr ) @ #i) ⇒
    ((∃ #j. IdP_Params( I, S, cid, ida, mh, idr ) @ #j) ∨
     (∃ I.1 #j #k.
       (Compromise_Agent( I.1 ) @ #j) ∧ (Register_SP_at_IdP( S, I.1 ) @ #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ S I cid ida mh idr #i.
  (SP_Params_IdP( S, I, cid, ida, mh, idr ) @ #i)
 ∧
  (∀ #j. (IdP_Params( I, S, cid, ida, mh, idr ) @ #j) ⇒ ⊥) ∧
  (∀ I.1 #j #k.
    (Compromise_Agent( I.1 ) @ #j) ∧ (Register_SP_at_IdP( S, I.1 ) @ #k)
   ⇒
    ⊥)"
*/
simplify
solve( SP_State_2( $SP, $IdP,
                   <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, $url,
                   <'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                    ~messageHandle, ~id_authnrequest>,
                   ~client_ID_TLS_C_SP, ~client_ID_TLS_SP_IdP
       ) ▶₀ #i )
  case SP_Resource_Request_With_Artifact_case_1
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_2
    by contradiction /* from formulas */
  qed
next
  case SP_Resource_Request_With_Artifact_case_2
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_2
    by contradiction /* from formulas */
  qed
next
  case SP_Resource_Request_With_Artifact_case_3
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_2
    by contradiction /* from formulas */
  qed
next
  case SP_Resource_Request_With_Artifact_case_4
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_2
    by contradiction /* from formulas */
  qed
qed

lemma sec_SP_IdP_Non_Injective_Agreement_Strong:
  all-traces
  "∀ S I cid ida mh idr #i.
    (SP_Params_IdP( S, I, cid, ida, mh, idr ) @ #i) ⇒
    ((∃ #j. IdP_Params( I, S, cid, ida, mh, idr ) @ #j) ∨
     (∃ #j. Compromise_Agent( I ) @ #j))"
/*
guarded formula characterizing all counter-examples:
"∃ S I cid ida mh idr #i.
  (SP_Params_IdP( S, I, cid, ida, mh, idr ) @ #i)
 ∧
  (∀ #j. (IdP_Params( I, S, cid, ida, mh, idr ) @ #j) ⇒ ⊥) ∧
  (∀ #j. (Compromise_Agent( I ) @ #j) ⇒ ⊥)"
*/
simplify
solve( SP_State_2( $SP, $IdP,
                   <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, $url,
                   <'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                    ~messageHandle, ~id_authnrequest>,
                   ~client_ID_TLS_C_SP, ~client_ID_TLS_SP_IdP
       ) ▶₀ #i )
  case SP_Resource_Request_With_Artifact_case_1
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_2
    by contradiction /* from formulas */
  qed
next
  case SP_Resource_Request_With_Artifact_case_2
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_2
    by contradiction /* from formulas */
  qed
next
  case SP_Resource_Request_With_Artifact_case_3
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_2
    by contradiction /* from formulas */
  qed
next
  case SP_Resource_Request_With_Artifact_case_4
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_2
    by contradiction /* from formulas */
  qed
qed

lemma sec_SP_IdP_Authentication_Freshness:
  all-traces
  "∀ S I cid ida mh idr url #i #j.
    ((SP_Params_IdP( S, I, cid, ida, mh, idr ) @ #i) ∧
     (SP_Resource_Request( S, I, ida, url ) @ #j)) ⇒
    ((∃ #k.
       (IdP_Client_Authentication( I, cid, <'AuthnRequest', ida, S, I> ) @ #k) ∧
       (#j < #k)) ∨
     (∃ I.1 #j.1 #k.
       (Compromise_Agent( I.1 ) @ #j.1) ∧ (Register_SP_at_IdP( S, I.1 ) @ #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ S I cid ida mh idr url #i #j.
  (SP_Params_IdP( S, I, cid, ida, mh, idr ) @ #i) ∧
  (SP_Resource_Request( S, I, ida, url ) @ #j)
 ∧
  (∀ #k.
    (IdP_Client_Authentication( I, cid, <'AuthnRequest', ida, S, I> ) @ #k)
   ⇒
    ¬(#j < #k)) ∧
  (∀ I.1 #j.1 #k.
    (Compromise_Agent( I.1 ) @ #j.1) ∧ (Register_SP_at_IdP( S, I.1 ) @ #k)
   ⇒
    ⊥)"
*/
simplify
solve( SP_State_2( $SP, $IdP,
                   <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, $url,
                   <'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                    ~messageHandle, ~id_authnrequest>,
                   ~client_ID_TLS_C_SP, ~client_ID_TLS_SP_IdP
       ) ▶₀ #i )
  case SP_Resource_Request_With_Artifact_case_1
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.3 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($SP, ~tls_session_id_C_SP.1,
                                <'ResourceRequest', $url.2>)
             ) @ #vk.4 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                  <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                  >)
               ) @ #vk.14 )
          case Adversary_Sends_as_Client
          by contradiction /* from formulas */
        qed
      qed
    qed
  next
    case IdP_Artifact_Resolution_case_2
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.3 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($SP, ~tls_session_id_C_SP.1,
                                <'ResourceRequest', $url.2>)
             ) @ #vk.4 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                  <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                  >)
               ) @ #vk.14 )
          case Adversary_Sends_as_Client
          solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                                    <$IdP, $url.3, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                                     sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)>)
                 ) @ #vk.16 )
            case Adversary_Sends_as_Client
            solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)
                   ) @ #vk.39 )
              case Adversary_Receives_as_Client
              solve( !Ltk( $IdP, ~ltkIdP ) ▶₁ #i )
                case Initialize_Agent
                solve( !Client_Has_Resource( $SP, ~clientID, $url, ~res ) ▶₂ #i )
                  case Adversary_Register_Resource_at_SP
                  solve( !SP_Initialized( $SP ) ▶₀ #j )
                    case Initialize_SP
                    solve( !Is_Resource( $url.1, $SP ) ▶₁ #j )
                      case Adversary_Register_Resource_at_SP
                      solve( !Is_Registered( $SP, $IdP ) ▶₂ #j )
                        case Register_SP_at_IdP
                        solve( !Ltk( $SP, ~ltkSP ) ▶₃ #j )
                          case Initialize_Agent
                          solve( New_Server_TLS_Session( $SP, ~tls_session_id_C_SP ) ▶₄ #j )
                            case Client_Starts_TLS
                            by solve( New_Id( ~id_authnrequest ) ▶₆ #j )
                          qed
                        qed
                      qed
                    next
                      case Register_Resource_at_SP
                      solve( !Is_Registered( $SP, $IdP ) ▶₂ #j )
                        case Register_SP_at_IdP
                        solve( !Ltk( $SP, ~ltkSP ) ▶₃ #j )
                          case Initialize_Agent
                          solve( New_Server_TLS_Session( $SP, ~tls_session_id_C_SP ) ▶₄ #j )
                            case Client_Starts_TLS
                            solve( New_Id( ~id_authnrequest ) ▶₆ #j )
                              case Generate_New_Id
                              by contradiction /* cyclic */
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case c_sign
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  qed
next
  case SP_Resource_Request_With_Artifact_case_2
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.3 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($SP, ~tls_session_id_C_SP.1,
                                <'ResourceRequest', $url.2>)
             ) @ #vk.4 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                  <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                  >)
               ) @ #vk.14 )
          case Adversary_Sends_as_Client
          by contradiction /* from formulas */
        qed
      qed
    qed
  next
    case IdP_Artifact_Resolution_case_2
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.3 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($SP, ~tls_session_id_C_SP.1,
                                <'ResourceRequest', $url.2>)
             ) @ #vk.4 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                  <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                  >)
               ) @ #vk.14 )
          case Adversary_Sends_as_Client
          solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                                    <$IdP, $url.3, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                                     sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)>)
                 ) @ #vk.16 )
            case Adversary_Sends_as_Client
            solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)
                   ) @ #vk.39 )
              case Adversary_Receives_as_Client
              solve( !Ltk( $IdP, ~ltkIdP ) ▶₁ #i )
                case Initialize_Agent
                solve( !Client_Has_Resource( $SP, ~clientID, $url, ~res ) ▶₂ #i )
                  case Adversary_Register_Resource_at_SP
                  solve( !SP_Initialized( $SP ) ▶₀ #j )
                    case Initialize_SP
                    solve( !Is_Resource( $url.1, $SP ) ▶₁ #j )
                      case Adversary_Register_Resource_at_SP
                      solve( !Is_Registered( $SP, $IdP ) ▶₂ #j )
                        case Register_SP_at_IdP
                        solve( !Ltk( $SP, ~ltkSP ) ▶₃ #j )
                          case Initialize_Agent
                          solve( New_Server_TLS_Session( $SP, ~tls_session_id_C_SP ) ▶₄ #j )
                            case Client_Starts_TLS
                            solve( New_Id( ~id_authnrequest ) ▶₆ #j )
                              case Generate_New_Id
                              by contradiction /* cyclic */
                            qed
                          qed
                        qed
                      qed
                    next
                      case Register_Resource_at_SP
                      solve( !Is_Registered( $SP, $IdP ) ▶₂ #j )
                        case Register_SP_at_IdP
                        solve( !Ltk( $SP, ~ltkSP ) ▶₃ #j )
                          case Initialize_Agent
                          solve( New_Server_TLS_Session( $SP, ~tls_session_id_C_SP ) ▶₄ #j )
                            case Client_Starts_TLS
                            by solve( New_Id( ~id_authnrequest ) ▶₆ #j )
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case c_sign
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  qed
next
  case SP_Resource_Request_With_Artifact_case_3
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.3 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($SP, ~tls_session_id_C_SP.1,
                                <'ResourceRequest', $url.2>)
             ) @ #vk.4 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                  <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                  >)
               ) @ #vk.14 )
          case Adversary_Sends_as_Client
          by contradiction /* from formulas */
        qed
      qed
    qed
  next
    case IdP_Artifact_Resolution_case_2
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.3 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($SP, ~tls_session_id_C_SP.1,
                                <'ResourceRequest', $url.2>)
             ) @ #vk.4 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                  <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                  >)
               ) @ #vk.14 )
          case Adversary_Sends_as_Client
          solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                                    <$IdP, $url.3, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                                     sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)>)
                 ) @ #vk.16 )
            case Adversary_Sends_as_Client
            solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)
                   ) @ #vk.39 )
              case Adversary_Receives_as_Client
              solve( !Ltk( $IdP, ~ltkIdP ) ▶₁ #i )
                case Initialize_Agent
                solve( !Client_Has_Resource( $SP, ~clientID, $url, ~res ) ▶₂ #i )
                  case Adversary_Register_Resource_at_SP
                  solve( !SP_Initialized( $SP ) ▶₀ #j )
                    case Initialize_SP
                    solve( !Is_Resource( $url.1, $SP ) ▶₁ #j )
                      case Adversary_Register_Resource_at_SP
                      solve( !Is_Registered( $SP, $IdP ) ▶₂ #j )
                        case Register_SP_at_IdP
                        solve( !Ltk( $SP, ~ltkSP ) ▶₃ #j )
                          case Initialize_Agent
                          solve( New_Server_TLS_Session( $SP, ~tls_session_id_C_SP ) ▶₄ #j )
                            case Client_Starts_TLS
                            by solve( New_Id( ~id_authnrequest ) ▶₆ #j )
                          qed
                        qed
                      qed
                    next
                      case Register_Resource_at_SP
                      solve( !Is_Registered( $SP, $IdP ) ▶₂ #j )
                        case Register_SP_at_IdP
                        solve( !Ltk( $SP, ~ltkSP ) ▶₃ #j )
                          case Initialize_Agent
                          solve( New_Server_TLS_Session( $SP, ~tls_session_id_C_SP ) ▶₄ #j )
                            case Client_Starts_TLS
                            solve( New_Id( ~id_authnrequest ) ▶₆ #j )
                              case Generate_New_Id
                              by contradiction /* cyclic */
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case c_sign
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  qed
next
  case SP_Resource_Request_With_Artifact_case_4
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.3 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($SP, ~tls_session_id_C_SP.1,
                                <'ResourceRequest', $url.2>)
             ) @ #vk.4 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                  <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                  >)
               ) @ #vk.14 )
          case Adversary_Sends_as_Client
          by contradiction /* from formulas */
        qed
      qed
    qed
  next
    case IdP_Artifact_Resolution_case_2
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.3 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($SP, ~tls_session_id_C_SP.1,
                                <'ResourceRequest', $url.2>)
             ) @ #vk.4 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                  <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                  >)
               ) @ #vk.14 )
          case Adversary_Sends_as_Client
          solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                                    <$IdP, $url.3, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                                     sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)>)
                 ) @ #vk.16 )
            case Adversary_Sends_as_Client
            solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)
                   ) @ #vk.39 )
              case Adversary_Receives_as_Client
              solve( !Ltk( $IdP, ~ltkIdP ) ▶₁ #i )
                case Initialize_Agent
                solve( !Client_Has_Resource( $SP, ~clientID, $url, ~res ) ▶₂ #i )
                  case Adversary_Register_Resource_at_SP
                  solve( !SP_Initialized( $SP ) ▶₀ #j )
                    case Initialize_SP
                    solve( !Is_Resource( $url.1, $SP ) ▶₁ #j )
                      case Adversary_Register_Resource_at_SP
                      solve( !Is_Registered( $SP, $IdP ) ▶₂ #j )
                        case Register_SP_at_IdP
                        solve( !Ltk( $SP, ~ltkSP ) ▶₃ #j )
                          case Initialize_Agent
                          solve( New_Server_TLS_Session( $SP, ~tls_session_id_C_SP ) ▶₄ #j )
                            case Client_Starts_TLS
                            solve( New_Id( ~id_authnrequest ) ▶₆ #j )
                              case Generate_New_Id
                              by contradiction /* cyclic */
                            qed
                          qed
                        qed
                      qed
                    next
                      case Register_Resource_at_SP
                      solve( !Is_Registered( $SP, $IdP ) ▶₂ #j )
                        case Register_SP_at_IdP
                        solve( !Ltk( $SP, ~ltkSP ) ▶₃ #j )
                          case Initialize_Agent
                          solve( New_Server_TLS_Session( $SP, ~tls_session_id_C_SP ) ▶₄ #j )
                            case Client_Starts_TLS
                            by solve( New_Id( ~id_authnrequest ) ▶₆ #j )
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case c_sign
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma sec_SP_IdP_Authentication_Freshness_Strong:
  all-traces
  "∀ S I cid ida mh idr url #i #j.
    ((SP_Params_IdP( S, I, cid, ida, mh, idr ) @ #i) ∧
     (SP_Resource_Request( S, I, ida, url ) @ #j)) ⇒
    ((∃ #k.
       (IdP_Client_Authentication( I, cid, <'AuthnRequest', ida, S, I> ) @ #k) ∧
       (#j < #k)) ∨
     (∃ #j.1. Compromise_Agent( I ) @ #j.1))"
/*
guarded formula characterizing all counter-examples:
"∃ S I cid ida mh idr url #i #j.
  (SP_Params_IdP( S, I, cid, ida, mh, idr ) @ #i) ∧
  (SP_Resource_Request( S, I, ida, url ) @ #j)
 ∧
  (∀ #k.
    (IdP_Client_Authentication( I, cid, <'AuthnRequest', ida, S, I> ) @ #k)
   ⇒
    ¬(#j < #k)) ∧
  (∀ #j.1. (Compromise_Agent( I ) @ #j.1) ⇒ ⊥)"
*/
simplify
solve( SP_State_2( $SP, $IdP,
                   <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, $url,
                   <'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                    ~messageHandle, ~id_authnrequest>,
                   ~client_ID_TLS_C_SP, ~client_ID_TLS_SP_IdP
       ) ▶₀ #i )
  case SP_Resource_Request_With_Artifact_case_1
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.3 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($SP, ~tls_session_id_C_SP.1,
                                <'ResourceRequest', $url.2>)
             ) @ #vk.4 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                  <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                  >)
               ) @ #vk.14 )
          case Adversary_Sends_as_Client
          by contradiction /* from formulas */
        qed
      qed
    qed
  next
    case IdP_Artifact_Resolution_case_2
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.3 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($SP, ~tls_session_id_C_SP.1,
                                <'ResourceRequest', $url.2>)
             ) @ #vk.4 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                  <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                  >)
               ) @ #vk.14 )
          case Adversary_Sends_as_Client
          solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                                    <$IdP, $url.3, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                                     sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)>)
                 ) @ #vk.16 )
            case Adversary_Sends_as_Client
            solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)
                   ) @ #vk.39 )
              case Adversary_Receives_as_Client
              solve( !Ltk( $IdP, ~ltkIdP ) ▶₁ #i )
                case Initialize_Agent
                solve( !Client_Has_Resource( $SP, ~clientID, $url, ~res ) ▶₂ #i )
                  case Adversary_Register_Resource_at_SP
                  solve( !SP_Initialized( $SP ) ▶₀ #j )
                    case Initialize_SP
                    solve( !Is_Resource( $url.1, $SP ) ▶₁ #j )
                      case Adversary_Register_Resource_at_SP
                      solve( !Is_Registered( $SP, $IdP ) ▶₂ #j )
                        case Register_SP_at_IdP
                        solve( !Ltk( $SP, ~ltkSP ) ▶₃ #j )
                          case Initialize_Agent
                          solve( New_Server_TLS_Session( $SP, ~tls_session_id_C_SP ) ▶₄ #j )
                            case Client_Starts_TLS
                            by solve( New_Id( ~id_authnrequest ) ▶₆ #j )
                          qed
                        qed
                      qed
                    next
                      case Register_Resource_at_SP
                      solve( !Is_Registered( $SP, $IdP ) ▶₂ #j )
                        case Register_SP_at_IdP
                        solve( !Ltk( $SP, ~ltkSP ) ▶₃ #j )
                          case Initialize_Agent
                          solve( New_Server_TLS_Session( $SP, ~tls_session_id_C_SP ) ▶₄ #j )
                            case Client_Starts_TLS
                            solve( New_Id( ~id_authnrequest ) ▶₆ #j )
                              case Generate_New_Id
                              by contradiction /* cyclic */
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case c_sign
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  qed
next
  case SP_Resource_Request_With_Artifact_case_2
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.3 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($SP, ~tls_session_id_C_SP.1,
                                <'ResourceRequest', $url.2>)
             ) @ #vk.4 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                  <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                  >)
               ) @ #vk.14 )
          case Adversary_Sends_as_Client
          by contradiction /* from formulas */
        qed
      qed
    qed
  next
    case IdP_Artifact_Resolution_case_2
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.3 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($SP, ~tls_session_id_C_SP.1,
                                <'ResourceRequest', $url.2>)
             ) @ #vk.4 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                  <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                  >)
               ) @ #vk.14 )
          case Adversary_Sends_as_Client
          solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                                    <$IdP, $url.3, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                                     sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)>)
                 ) @ #vk.16 )
            case Adversary_Sends_as_Client
            solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)
                   ) @ #vk.39 )
              case Adversary_Receives_as_Client
              solve( !Ltk( $IdP, ~ltkIdP ) ▶₁ #i )
                case Initialize_Agent
                solve( !Client_Has_Resource( $SP, ~clientID, $url, ~res ) ▶₂ #i )
                  case Adversary_Register_Resource_at_SP
                  solve( !SP_Initialized( $SP ) ▶₀ #j )
                    case Initialize_SP
                    solve( !Is_Resource( $url.1, $SP ) ▶₁ #j )
                      case Adversary_Register_Resource_at_SP
                      solve( !Is_Registered( $SP, $IdP ) ▶₂ #j )
                        case Register_SP_at_IdP
                        solve( !Ltk( $SP, ~ltkSP ) ▶₃ #j )
                          case Initialize_Agent
                          solve( New_Server_TLS_Session( $SP, ~tls_session_id_C_SP ) ▶₄ #j )
                            case Client_Starts_TLS
                            solve( New_Id( ~id_authnrequest ) ▶₆ #j )
                              case Generate_New_Id
                              by contradiction /* cyclic */
                            qed
                          qed
                        qed
                      qed
                    next
                      case Register_Resource_at_SP
                      solve( !Is_Registered( $SP, $IdP ) ▶₂ #j )
                        case Register_SP_at_IdP
                        solve( !Ltk( $SP, ~ltkSP ) ▶₃ #j )
                          case Initialize_Agent
                          solve( New_Server_TLS_Session( $SP, ~tls_session_id_C_SP ) ▶₄ #j )
                            case Client_Starts_TLS
                            by solve( New_Id( ~id_authnrequest ) ▶₆ #j )
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case c_sign
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  qed
next
  case SP_Resource_Request_With_Artifact_case_3
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.3 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($SP, ~tls_session_id_C_SP.1,
                                <'ResourceRequest', $url.2>)
             ) @ #vk.4 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                  <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                  >)
               ) @ #vk.14 )
          case Adversary_Sends_as_Client
          by contradiction /* from formulas */
        qed
      qed
    qed
  next
    case IdP_Artifact_Resolution_case_2
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.3 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($SP, ~tls_session_id_C_SP.1,
                                <'ResourceRequest', $url.2>)
             ) @ #vk.4 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                  <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                  >)
               ) @ #vk.14 )
          case Adversary_Sends_as_Client
          solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                                    <$IdP, $url.3, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                                     sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)>)
                 ) @ #vk.16 )
            case Adversary_Sends_as_Client
            solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)
                   ) @ #vk.39 )
              case Adversary_Receives_as_Client
              solve( !Ltk( $IdP, ~ltkIdP ) ▶₁ #i )
                case Initialize_Agent
                solve( !Client_Has_Resource( $SP, ~clientID, $url, ~res ) ▶₂ #i )
                  case Adversary_Register_Resource_at_SP
                  solve( !SP_Initialized( $SP ) ▶₀ #j )
                    case Initialize_SP
                    solve( !Is_Resource( $url.1, $SP ) ▶₁ #j )
                      case Adversary_Register_Resource_at_SP
                      solve( !Is_Registered( $SP, $IdP ) ▶₂ #j )
                        case Register_SP_at_IdP
                        solve( !Ltk( $SP, ~ltkSP ) ▶₃ #j )
                          case Initialize_Agent
                          solve( New_Server_TLS_Session( $SP, ~tls_session_id_C_SP ) ▶₄ #j )
                            case Client_Starts_TLS
                            by solve( New_Id( ~id_authnrequest ) ▶₆ #j )
                          qed
                        qed
                      qed
                    next
                      case Register_Resource_at_SP
                      solve( !Is_Registered( $SP, $IdP ) ▶₂ #j )
                        case Register_SP_at_IdP
                        solve( !Ltk( $SP, ~ltkSP ) ▶₃ #j )
                          case Initialize_Agent
                          solve( New_Server_TLS_Session( $SP, ~tls_session_id_C_SP ) ▶₄ #j )
                            case Client_Starts_TLS
                            solve( New_Id( ~id_authnrequest ) ▶₆ #j )
                              case Generate_New_Id
                              by contradiction /* cyclic */
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case c_sign
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  qed
next
  case SP_Resource_Request_With_Artifact_case_4
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.3 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($SP, ~tls_session_id_C_SP.1,
                                <'ResourceRequest', $url.2>)
             ) @ #vk.4 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                  <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                  >)
               ) @ #vk.14 )
          case Adversary_Sends_as_Client
          by contradiction /* from formulas */
        qed
      qed
    qed
  next
    case IdP_Artifact_Resolution_case_2
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.3 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($SP, ~tls_session_id_C_SP.1,
                                <'ResourceRequest', $url.2>)
             ) @ #vk.4 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                  <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                  >)
               ) @ #vk.14 )
          case Adversary_Sends_as_Client
          solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                                    <$IdP, $url.3, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                                     sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)>)
                 ) @ #vk.16 )
            case Adversary_Sends_as_Client
            solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)
                   ) @ #vk.39 )
              case Adversary_Receives_as_Client
              solve( !Ltk( $IdP, ~ltkIdP ) ▶₁ #i )
                case Initialize_Agent
                solve( !Client_Has_Resource( $SP, ~clientID, $url, ~res ) ▶₂ #i )
                  case Adversary_Register_Resource_at_SP
                  solve( !SP_Initialized( $SP ) ▶₀ #j )
                    case Initialize_SP
                    solve( !Is_Resource( $url.1, $SP ) ▶₁ #j )
                      case Adversary_Register_Resource_at_SP
                      solve( !Is_Registered( $SP, $IdP ) ▶₂ #j )
                        case Register_SP_at_IdP
                        solve( !Ltk( $SP, ~ltkSP ) ▶₃ #j )
                          case Initialize_Agent
                          solve( New_Server_TLS_Session( $SP, ~tls_session_id_C_SP ) ▶₄ #j )
                            case Client_Starts_TLS
                            solve( New_Id( ~id_authnrequest ) ▶₆ #j )
                              case Generate_New_Id
                              by contradiction /* cyclic */
                            qed
                          qed
                        qed
                      qed
                    next
                      case Register_Resource_at_SP
                      solve( !Is_Registered( $SP, $IdP ) ▶₂ #j )
                        case Register_SP_at_IdP
                        solve( !Ltk( $SP, ~ltkSP ) ▶₃ #j )
                          case Initialize_Agent
                          solve( New_Server_TLS_Session( $SP, ~tls_session_id_C_SP ) ▶₄ #j )
                            case Client_Starts_TLS
                            by solve( New_Id( ~id_authnrequest ) ▶₆ #j )
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case c_sign
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma sec_SP_IdP_Assertion_Secrecy:
  all-traces
  "∀ S I sec #i.
    (SP_Assertion_Secret( S, I, sec ) @ #i) ⇒
    ((¬(∃ #k. K( sec ) @ #k)) ∨
     (∃ I.1 #k #l.
       (Compromise_Agent( I.1 ) @ #k) ∧ (Register_SP_at_IdP( S, I.1 ) @ #l)))"
/*
guarded formula characterizing all counter-examples:
"∃ S I sec #i.
  (SP_Assertion_Secret( S, I, sec ) @ #i)
 ∧
  (∃ #k. (K( sec ) @ #k)) ∧
  (∀ I.1 #k #l.
    (Compromise_Agent( I.1 ) @ #k) ∧ (Register_SP_at_IdP( S, I.1 ) @ #l)
   ⇒
    ⊥)"
*/
simplify
solve( SP_State_2( $SP, $IdP,
                   <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, $url,
                   <'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                    ~messageHandle, ~id_authnrequest>,
                   ~client_ID_TLS_C_SP, ~client_ID_TLS_SP_IdP
       ) ▶₀ #i )
  case SP_Resource_Request_With_Artifact_case_1
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.4 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                >)
             ) @ #vk.14 )
        case Adversary_Sends_as_Client
        by contradiction /* from formulas */
      qed
    qed
  next
    case IdP_Artifact_Resolution_case_2
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.4 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                >)
             ) @ #vk.14 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                                  <$IdP, $url.2, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                                   sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)>)
               ) @ #vk.16 )
          case Adversary_Sends_as_Client
          solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)
                 ) @ #vk.37 )
            case Adversary_Receives_as_Client
            solve( !Ltk( $IdP, ~ltkIdP ) ▶₁ #i )
              case Initialize_Agent
              solve( !Client_Has_Resource( $SP, ~clientID, $url, ~res ) ▶₂ #i )
                case Adversary_Register_Resource_at_SP
                solve( !KU( ~assertion_secret ) @ #vk.10 )
                  case Adversary_Receives_as_Client_case_1
                  by contradiction /* from formulas */
                next
                  case Adversary_Receives_as_Client_case_2
                  solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                            <$Server, $url.3, 
                                             <'AuthnRequest', ~assertion_secret, $SP.1, $Server>, 
                                             sign(<'AuthnRequest', ~assertion_secret, $SP.1, $Server>,
                                                  ~ltkSP.1)
                                            >)
                         ) @ #vk.42 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_1
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_2
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_3
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_4
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            qed
          next
            case c_sign
            by contradiction /* from formulas */
          qed
        qed
      qed
    qed
  qed
next
  case SP_Resource_Request_With_Artifact_case_2
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.4 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                >)
             ) @ #vk.14 )
        case Adversary_Sends_as_Client
        by contradiction /* from formulas */
      qed
    qed
  next
    case IdP_Artifact_Resolution_case_2
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.4 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                >)
             ) @ #vk.14 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                                  <$IdP, $url.2, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                                   sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)>)
               ) @ #vk.16 )
          case Adversary_Sends_as_Client
          solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)
                 ) @ #vk.37 )
            case Adversary_Receives_as_Client
            solve( !Ltk( $IdP, ~ltkIdP ) ▶₁ #i )
              case Initialize_Agent
              solve( !Client_Has_Resource( $SP, ~clientID, $url, ~res ) ▶₂ #i )
                case Adversary_Register_Resource_at_SP
                solve( !KU( ~assertion_secret ) @ #vk.10 )
                  case Adversary_Receives_as_Client_case_1
                  by contradiction /* from formulas */
                next
                  case Adversary_Receives_as_Client_case_2
                  solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                            <$Server, $url.3, 
                                             <'AuthnRequest', ~assertion_secret, $SP.1, $Server>, 
                                             sign(<'AuthnRequest', ~assertion_secret, $SP.1, $Server>,
                                                  ~ltkSP.1)
                                            >)
                         ) @ #vk.42 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_1
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_2
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_3
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_4
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            qed
          next
            case c_sign
            by contradiction /* from formulas */
          qed
        qed
      qed
    qed
  qed
next
  case SP_Resource_Request_With_Artifact_case_3
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.4 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                >)
             ) @ #vk.14 )
        case Adversary_Sends_as_Client
        by contradiction /* from formulas */
      qed
    qed
  next
    case IdP_Artifact_Resolution_case_2
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.4 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                >)
             ) @ #vk.14 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                                  <$IdP, $url.2, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                                   sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)>)
               ) @ #vk.16 )
          case Adversary_Sends_as_Client
          solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)
                 ) @ #vk.37 )
            case Adversary_Receives_as_Client
            solve( !Ltk( $IdP, ~ltkIdP ) ▶₁ #i )
              case Initialize_Agent
              solve( !Client_Has_Resource( $SP, ~clientID, $url, ~res ) ▶₂ #i )
                case Adversary_Register_Resource_at_SP
                solve( !KU( ~assertion_secret ) @ #vk.10 )
                  case Adversary_Receives_as_Client_case_1
                  by contradiction /* from formulas */
                next
                  case Adversary_Receives_as_Client_case_2
                  solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                            <$Server, $url.3, 
                                             <'AuthnRequest', ~assertion_secret, $SP.1, $Server>, 
                                             sign(<'AuthnRequest', ~assertion_secret, $SP.1, $Server>,
                                                  ~ltkSP.1)
                                            >)
                         ) @ #vk.42 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_1
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_2
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_3
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_4
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            qed
          next
            case c_sign
            by contradiction /* from formulas */
          qed
        qed
      qed
    qed
  qed
next
  case SP_Resource_Request_With_Artifact_case_4
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.4 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                >)
             ) @ #vk.14 )
        case Adversary_Sends_as_Client
        by contradiction /* from formulas */
      qed
    qed
  next
    case IdP_Artifact_Resolution_case_2
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.4 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                >)
             ) @ #vk.14 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                                  <$IdP, $url.2, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                                   sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)>)
               ) @ #vk.16 )
          case Adversary_Sends_as_Client
          solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)
                 ) @ #vk.37 )
            case Adversary_Receives_as_Client
            solve( !Ltk( $IdP, ~ltkIdP ) ▶₁ #i )
              case Initialize_Agent
              solve( !Client_Has_Resource( $SP, ~clientID, $url, ~res ) ▶₂ #i )
                case Adversary_Register_Resource_at_SP
                solve( !KU( ~assertion_secret ) @ #vk.10 )
                  case Adversary_Receives_as_Client_case_1
                  by contradiction /* from formulas */
                next
                  case Adversary_Receives_as_Client_case_2
                  solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                            <$Server, $url.3, 
                                             <'AuthnRequest', ~assertion_secret, $SP.1, $Server>, 
                                             sign(<'AuthnRequest', ~assertion_secret, $SP.1, $Server>,
                                                  ~ltkSP.1)
                                            >)
                         ) @ #vk.42 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_1
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_2
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_3
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_4
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            qed
          next
            case c_sign
            by contradiction /* from formulas */
          qed
        qed
      qed
    qed
  qed
qed

lemma sec_SP_IdP_Assertion_Secrecy_Strong:
  all-traces
  "∀ S I sec #i.
    (SP_Assertion_Secret( S, I, sec ) @ #i) ⇒
    ((¬(∃ #k. K( sec ) @ #k)) ∨ (∃ #k. Compromise_Agent( I ) @ #k))"
/*
guarded formula characterizing all counter-examples:
"∃ S I sec #i.
  (SP_Assertion_Secret( S, I, sec ) @ #i)
 ∧
  (∃ #k. (K( sec ) @ #k)) ∧ (∀ #k. (Compromise_Agent( I ) @ #k) ⇒ ⊥)"
*/
simplify
solve( SP_State_2( $SP, $IdP,
                   <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, $url,
                   <'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                    ~messageHandle, ~id_authnrequest>,
                   ~client_ID_TLS_C_SP, ~client_ID_TLS_SP_IdP
       ) ▶₀ #i )
  case SP_Resource_Request_With_Artifact_case_1
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.4 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                >)
             ) @ #vk.14 )
        case Adversary_Sends_as_Client
        by contradiction /* from formulas */
      qed
    qed
  next
    case IdP_Artifact_Resolution_case_2
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.4 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                >)
             ) @ #vk.14 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                                  <$IdP, $url.2, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                                   sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)>)
               ) @ #vk.16 )
          case Adversary_Sends_as_Client
          solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)
                 ) @ #vk.37 )
            case Adversary_Receives_as_Client
            solve( !Ltk( $IdP, ~ltkIdP ) ▶₁ #i )
              case Initialize_Agent
              solve( !Client_Has_Resource( $SP, ~clientID, $url, ~res ) ▶₂ #i )
                case Adversary_Register_Resource_at_SP
                solve( !KU( ~assertion_secret ) @ #vk.10 )
                  case Adversary_Receives_as_Client_case_1
                  by contradiction /* from formulas */
                next
                  case Adversary_Receives_as_Client_case_2
                  solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                            <$Server, $url.3, 
                                             <'AuthnRequest', ~assertion_secret, $SP.1, $Server>, 
                                             sign(<'AuthnRequest', ~assertion_secret, $SP.1, $Server>,
                                                  ~ltkSP.1)
                                            >)
                         ) @ #vk.42 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_1
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_2
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_3
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_4
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            qed
          next
            case c_sign
            by contradiction /* from formulas */
          qed
        qed
      qed
    qed
  qed
next
  case SP_Resource_Request_With_Artifact_case_2
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.4 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                >)
             ) @ #vk.14 )
        case Adversary_Sends_as_Client
        by contradiction /* from formulas */
      qed
    qed
  next
    case IdP_Artifact_Resolution_case_2
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.4 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                >)
             ) @ #vk.14 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                                  <$IdP, $url.2, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                                   sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)>)
               ) @ #vk.16 )
          case Adversary_Sends_as_Client
          solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)
                 ) @ #vk.37 )
            case Adversary_Receives_as_Client
            solve( !Ltk( $IdP, ~ltkIdP ) ▶₁ #i )
              case Initialize_Agent
              solve( !Client_Has_Resource( $SP, ~clientID, $url, ~res ) ▶₂ #i )
                case Adversary_Register_Resource_at_SP
                solve( !KU( ~assertion_secret ) @ #vk.10 )
                  case Adversary_Receives_as_Client_case_1
                  by contradiction /* from formulas */
                next
                  case Adversary_Receives_as_Client_case_2
                  solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                            <$Server, $url.3, 
                                             <'AuthnRequest', ~assertion_secret, $SP.1, $Server>, 
                                             sign(<'AuthnRequest', ~assertion_secret, $SP.1, $Server>,
                                                  ~ltkSP.1)
                                            >)
                         ) @ #vk.42 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_1
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_2
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_3
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_4
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            qed
          next
            case c_sign
            by contradiction /* from formulas */
          qed
        qed
      qed
    qed
  qed
next
  case SP_Resource_Request_With_Artifact_case_3
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.4 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                >)
             ) @ #vk.14 )
        case Adversary_Sends_as_Client
        by contradiction /* from formulas */
      qed
    qed
  next
    case IdP_Artifact_Resolution_case_2
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.4 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                >)
             ) @ #vk.14 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                                  <$IdP, $url.2, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                                   sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)>)
               ) @ #vk.16 )
          case Adversary_Sends_as_Client
          solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)
                 ) @ #vk.37 )
            case Adversary_Receives_as_Client
            solve( !Ltk( $IdP, ~ltkIdP ) ▶₁ #i )
              case Initialize_Agent
              solve( !Client_Has_Resource( $SP, ~clientID, $url, ~res ) ▶₂ #i )
                case Adversary_Register_Resource_at_SP
                solve( !KU( ~assertion_secret ) @ #vk.10 )
                  case Adversary_Receives_as_Client_case_1
                  by contradiction /* from formulas */
                next
                  case Adversary_Receives_as_Client_case_2
                  solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                            <$Server, $url.3, 
                                             <'AuthnRequest', ~assertion_secret, $SP.1, $Server>, 
                                             sign(<'AuthnRequest', ~assertion_secret, $SP.1, $Server>,
                                                  ~ltkSP.1)
                                            >)
                         ) @ #vk.42 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_1
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_2
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_3
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_4
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            qed
          next
            case c_sign
            by contradiction /* from formulas */
          qed
        qed
      qed
    qed
  qed
next
  case SP_Resource_Request_With_Artifact_case_4
  solve( !KU( https_response(~client_ID_TLS_SP_IdP,
                             <
                              <'ArtifactResponse', $IdP, ~id_artifactresolve, 
                               <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                <'Audience', $SP>, ~assertion_secret>, 
                               ResponseSignature>, 
                              sign(<'ArtifactResponse', $IdP, ~id_artifactresolve, 
                                    <'Response', ~id_response, $IdP, ~id_authnrequest, 'Assertion', 
                                     ~id_assertion, $IdP, <'Subject', ~clientID, ~id_authnrequest>, 
                                     <'Audience', $SP>, ~assertion_secret>, 
                                    ResponseSignature>,
                                   ~ltkIdP)
                             >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Server
    by contradiction /* from formulas */
  next
    case IdP_Artifact_Resolution_case_1
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.4 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                >)
             ) @ #vk.14 )
        case Adversary_Sends_as_Client
        by contradiction /* from formulas */
      qed
    qed
  next
    case IdP_Artifact_Resolution_case_2
    solve( !KU( https_request($SP, ~tls_session_id_C_SP,
                              <'ResourceRequest', $url.1>)
           ) @ #vk.4 )
      case Adversary_Sends_as_Client
      solve( !KU( https_request($IdP, ~client_ID_TLS_C_IdP,
                                <'IAuthAndConsent', ~clientID, $SP, $IdP, ~clientSecret.1, ~auth_session
                                >)
             ) @ #vk.14 )
        case Adversary_Sends_as_Client
        solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                                  <$IdP, $url.2, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                                   sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)>)
               ) @ #vk.16 )
          case Adversary_Sends_as_Client
          solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)
                 ) @ #vk.37 )
            case Adversary_Receives_as_Client
            solve( !Ltk( $IdP, ~ltkIdP ) ▶₁ #i )
              case Initialize_Agent
              solve( !Client_Has_Resource( $SP, ~clientID, $url, ~res ) ▶₂ #i )
                case Adversary_Register_Resource_at_SP
                solve( !KU( ~assertion_secret ) @ #vk.10 )
                  case Adversary_Receives_as_Client_case_1
                  by contradiction /* from formulas */
                next
                  case Adversary_Receives_as_Client_case_2
                  solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                            <$Server, $url.3, 
                                             <'AuthnRequest', ~assertion_secret, $SP.1, $Server>, 
                                             sign(<'AuthnRequest', ~assertion_secret, $SP.1, $Server>,
                                                  ~ltkSP.1)
                                            >)
                         ) @ #vk.42 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_1
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_2
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_3
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_4
                  solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                            <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                             $url.3>)
                         ) @ #vk.40 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            qed
          next
            case c_sign
            by contradiction /* from formulas */
          qed
        qed
      qed
    qed
  qed
qed

lemma sec_IdP_SP_Non_Injective_Pre_Agreement:
  all-traces
  "∀ I S cid ida mh idr #i.
    (IdP_Params( I, S, cid, ida, mh, idr ) @ #i) ⇒
    ((∃ url #j. SP_Resource_Request( S, I, ida, url ) @ #j) ∨
     (∃ #j. Compromise_Agent( S ) @ #j))"
/*
guarded formula characterizing all counter-examples:
"∃ I S cid ida mh idr #i.
  (IdP_Params( I, S, cid, ida, mh, idr ) @ #i)
 ∧
  (∀ url #j. (SP_Resource_Request( S, I, ida, url ) @ #j) ⇒ ⊥) ∧
  (∀ #j. (Compromise_Agent( S ) @ #j) ⇒ ⊥)"
*/
simplify
solve( IdP_State_2( $IdP, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>,
                    <'Artifact', $IdP, ~messageHandle, ~id_authnrequest>, ~clientID
       ) ▶₀ #i )
  case IdP_Client_Authentication_case_1
  by contradiction /* from formulas */
next
  case IdP_Client_Authentication_case_2
  solve( !KU( https_request($IdP, ~client_ID_TLS_SP_IdP,
                            <
                             <'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                              ~messageHandle, ~id_authnrequest>, 
                             sign(<'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                                   ~messageHandle, ~id_authnrequest>,
                                  ~ltkSP)
                            >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Client
    solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve, $SP, 
                      'Artifact', $IdP, ~messageHandle, ~id_authnrequest>,
                     ~ltkSP)
           ) @ #vk.26 )
      case c_sign
      solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                                <$IdP, $url, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                                 sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)>)
             ) @ #vk.3 )
        case Adversary_Sends_as_Client
        solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)
               ) @ #vk.36 )
          case Adversary_Receives_as_Client_case_1
          by contradiction /* from formulas */
        next
          case Adversary_Receives_as_Client_case_2
          by contradiction /* from formulas */
        next
          case c_sign
          by contradiction /* from formulas */
        qed
      qed
    qed
  next
    case SP_Resource_Request_With_Artifact_case_1
    by contradiction /* from formulas */
  next
    case SP_Resource_Request_With_Artifact_case_2
    by contradiction /* from formulas */
  next
    case SP_Resource_Request_With_Artifact_case_3
    by contradiction /* from formulas */
  next
    case SP_Resource_Request_With_Artifact_case_4
    by contradiction /* from formulas */
  qed
qed

lemma sec_IdP_SP_Weak_Agreement:
  all-traces
  "∀ I S cid ida mh idr #i.
    (IdP_Params( I, S, cid, ida, mh, idr ) @ #i) ⇒
    ((∃ ida1 #j. SP_Resource_Request_With_Artifact( S, I, ida1, mh ) @ #j) ∨
     (∃ #j. Compromise_Agent( S ) @ #j))"
/*
guarded formula characterizing all counter-examples:
"∃ I S cid ida mh idr #i.
  (IdP_Params( I, S, cid, ida, mh, idr ) @ #i)
 ∧
  (∀ ida1 #j.
    (SP_Resource_Request_With_Artifact( S, I, ida1, mh ) @ #j) ⇒ ⊥) ∧
  (∀ #j. (Compromise_Agent( S ) @ #j) ⇒ ⊥)"
*/
simplify
solve( IdP_State_2( $IdP, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>,
                    <'Artifact', $IdP, ~messageHandle, ~id_authnrequest>, ~clientID
       ) ▶₀ #i )
  case IdP_Client_Authentication_case_1
  by contradiction /* from formulas */
next
  case IdP_Client_Authentication_case_2
  solve( !KU( https_request($IdP, ~client_ID_TLS_SP_IdP,
                            <
                             <'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                              ~messageHandle, ~id_authnrequest>, 
                             sign(<'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                                   ~messageHandle, ~id_authnrequest>,
                                  ~ltkSP)
                            >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Client
    solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve, $SP, 
                      'Artifact', $IdP, ~messageHandle, ~id_authnrequest>,
                     ~ltkSP)
           ) @ #vk.26 )
      case c_sign
      solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                                <$IdP, $url, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                                 sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)>)
             ) @ #vk.3 )
        case Adversary_Sends_as_Client
        solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)
               ) @ #vk.36 )
          case Adversary_Receives_as_Client_case_1
          solve( !KU( ~ltkSP ) @ #vk.34 )
            case Adversary_Receives_as_Client_case_01
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Receives_as_Client_case_02
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Receives_as_Client_case_03
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_04
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_05
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_06
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_07
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_08
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_09
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_10
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_11
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_12
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_13
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_14
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_15
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_16
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_17
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_18
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_19
            solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                             ~ltkSP.2)
                   ) @ #vk.54 )
              case Adversary_Receives_as_Client_case_1
              by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
            next
              case Adversary_Receives_as_Client_case_2
              by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
            next
              case c_sign
              solve( !KU( ~ltkSP.2 ) @ #vk.55 )
                case Adversary_Receives_as_Client_case_1
                by contradiction /* from formulas */
              next
                case Adversary_Receives_as_Client_case_2
                solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                          <$Server.1, $url.3, <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                           sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)>)
                       ) @ #vk.59 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_1
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_2
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_3
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_4
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Compromise_Agent
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_20
            by contradiction /* from formulas */
          next
            case Adversary_Receives_as_Client_case_21
            solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                      <$Server, $url.2, <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                       sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, ~ltkSP.2)>)
                   ) @ #vk.45 )
              case Adversary_Sends_as_Client
              solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                               ~ltkSP.2)
                     ) @ #vk.63 )
                case Adversary_Receives_as_Client_case_1
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              next
                case Adversary_Receives_as_Client_case_2
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              next
                case c_sign
                solve( !KU( ~ltkSP.2 ) @ #vk.64 )
                  case Adversary_Receives_as_Client_case_1
                  by contradiction /* from formulas */
                next
                  case Adversary_Receives_as_Client_case_2
                  solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                            <$Server.1, $url.3, <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                             sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)>)
                         ) @ #vk.68 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_1
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_2
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_3
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_4
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Compromise_Agent
                  by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_22
            by contradiction /* from formulas */
          next
            case Adversary_Receives_as_Client_case_23
            solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                      <$Server, $url.2, <'AuthnRequest', ~ltkSP, $SP.1, $Server>, 
                                       sign(<'AuthnRequest', ~ltkSP, $SP.1, $Server>, ~ltkSP.2)>)
                   ) @ #vk.45 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Client_case_24
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_25
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.52 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.75 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.69 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.79 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_26
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_27
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~ltkSP, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* cyclic */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_28
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_29
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.52 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.75 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.69 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.79 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_30
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~ltkSP, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* cyclic */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_31
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.52 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.75 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.69 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.79 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_01
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_02
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_03
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_04
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_05
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_06
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_07
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_08
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_09
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_10
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_11
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_12
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Register_Client_at_IdP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Register_Resource_at_SP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Compromise_Agent
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Initialize_Agent
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Register_Client_at_Compromised_IdP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case fresh
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          qed
        next
          case Adversary_Receives_as_Client_case_2
          solve( !KU( ~ltkSP ) @ #vk.34 )
            case Adversary_Receives_as_Client_case_01
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Receives_as_Client_case_02
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Receives_as_Client_case_03
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_04
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_05
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_06
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_07
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_08
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_09
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_10
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_11
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_12
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_13
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_14
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_15
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_16
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_17
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_18
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_19
            solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                             ~ltkSP.2)
                   ) @ #vk.54 )
              case Adversary_Receives_as_Client_case_1
              by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
            next
              case Adversary_Receives_as_Client_case_2
              by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
            next
              case c_sign
              solve( !KU( ~ltkSP.2 ) @ #vk.55 )
                case Adversary_Receives_as_Client_case_1
                by contradiction /* from formulas */
              next
                case Adversary_Receives_as_Client_case_2
                solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                          <$Server.1, $url.3, <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                           sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)>)
                       ) @ #vk.59 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_1
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_2
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_3
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_4
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Compromise_Agent
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_20
            by contradiction /* from formulas */
          next
            case Adversary_Receives_as_Client_case_21
            solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                      <$Server, $url.2, <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                       sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, ~ltkSP.2)>)
                   ) @ #vk.45 )
              case Adversary_Sends_as_Client
              solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                               ~ltkSP.2)
                     ) @ #vk.63 )
                case Adversary_Receives_as_Client_case_1
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              next
                case Adversary_Receives_as_Client_case_2
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              next
                case c_sign
                solve( !KU( ~ltkSP.2 ) @ #vk.64 )
                  case Adversary_Receives_as_Client_case_1
                  by contradiction /* from formulas */
                next
                  case Adversary_Receives_as_Client_case_2
                  solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                            <$Server.1, $url.3, <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                             sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)>)
                         ) @ #vk.68 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_1
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_2
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_3
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_4
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Compromise_Agent
                  by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_22
            by contradiction /* from formulas */
          next
            case Adversary_Receives_as_Client_case_23
            solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                      <$Server, $url.2, <'AuthnRequest', ~ltkSP, $SP.1, $Server>, 
                                       sign(<'AuthnRequest', ~ltkSP, $SP.1, $Server>, ~ltkSP.2)>)
                   ) @ #vk.45 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Client_case_24
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_25
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.52 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.75 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.69 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.79 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_26
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_27
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~ltkSP, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* cyclic */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_28
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_29
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.52 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.75 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.69 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.79 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_30
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~ltkSP, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* cyclic */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_31
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.52 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.75 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.69 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.79 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_01
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_02
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_03
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_04
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_05
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_06
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_07
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_08
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_09
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_10
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_11
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_12
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Register_Client_at_IdP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Register_Resource_at_SP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Compromise_Agent
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Initialize_Agent
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Register_Client_at_Compromised_IdP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case fresh
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          qed
        next
          case c_sign
          by contradiction /* from formulas */
        qed
      qed
    qed
  next
    case SP_Resource_Request_With_Artifact_case_1
    by contradiction /* from formulas */
  next
    case SP_Resource_Request_With_Artifact_case_2
    by contradiction /* from formulas */
  next
    case SP_Resource_Request_With_Artifact_case_3
    by contradiction /* from formulas */
  next
    case SP_Resource_Request_With_Artifact_case_4
    by contradiction /* from formulas */
  qed
qed

lemma sec_IdP_SP_Non_Injective_Agreement:
  all-traces
  "∀ I S cid ida mh idr #i.
    (IdP_Params( I, S, cid, ida, mh, idr ) @ #i) ⇒
    ((∃ #j. SP_Resource_Request_With_Artifact( S, I, ida, mh ) @ #j) ∨
     (∃ #j. Compromise_Agent( S ) @ #j))"
/*
guarded formula characterizing all counter-examples:
"∃ I S cid ida mh idr #i.
  (IdP_Params( I, S, cid, ida, mh, idr ) @ #i)
 ∧
  (∀ #j. (SP_Resource_Request_With_Artifact( S, I, ida, mh ) @ #j) ⇒ ⊥) ∧
  (∀ #j. (Compromise_Agent( S ) @ #j) ⇒ ⊥)"
*/
simplify
solve( IdP_State_2( $IdP, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>,
                    <'Artifact', $IdP, ~messageHandle, ~id_authnrequest>, ~clientID
       ) ▶₀ #i )
  case IdP_Client_Authentication_case_1
  by contradiction /* from formulas */
next
  case IdP_Client_Authentication_case_2
  solve( !KU( https_request($IdP, ~client_ID_TLS_SP_IdP,
                            <
                             <'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                              ~messageHandle, ~id_authnrequest>, 
                             sign(<'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                                   ~messageHandle, ~id_authnrequest>,
                                  ~ltkSP)
                            >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Client
    solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve, $SP, 
                      'Artifact', $IdP, ~messageHandle, ~id_authnrequest>,
                     ~ltkSP)
           ) @ #vk.26 )
      case c_sign
      solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                                <$IdP, $url, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                                 sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)>)
             ) @ #vk.3 )
        case Adversary_Sends_as_Client
        solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)
               ) @ #vk.36 )
          case Adversary_Receives_as_Client_case_1
          solve( !KU( ~ltkSP ) @ #vk.34 )
            case Adversary_Receives_as_Client_case_01
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Receives_as_Client_case_02
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Receives_as_Client_case_03
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_04
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_05
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_06
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_07
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_08
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_09
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_10
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_11
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_12
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_13
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_14
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_15
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_16
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_17
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_18
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_19
            solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                             ~ltkSP.2)
                   ) @ #vk.54 )
              case Adversary_Receives_as_Client_case_1
              by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
            next
              case Adversary_Receives_as_Client_case_2
              by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
            next
              case c_sign
              solve( !KU( ~ltkSP.2 ) @ #vk.55 )
                case Adversary_Receives_as_Client_case_1
                by contradiction /* from formulas */
              next
                case Adversary_Receives_as_Client_case_2
                solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                          <$Server.1, $url.3, <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                           sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)>)
                       ) @ #vk.59 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_1
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_2
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_3
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_4
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Compromise_Agent
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_20
            by contradiction /* from formulas */
          next
            case Adversary_Receives_as_Client_case_21
            solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                      <$Server, $url.2, <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                       sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, ~ltkSP.2)>)
                   ) @ #vk.45 )
              case Adversary_Sends_as_Client
              solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                               ~ltkSP.2)
                     ) @ #vk.63 )
                case Adversary_Receives_as_Client_case_1
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              next
                case Adversary_Receives_as_Client_case_2
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              next
                case c_sign
                solve( !KU( ~ltkSP.2 ) @ #vk.64 )
                  case Adversary_Receives_as_Client_case_1
                  by contradiction /* from formulas */
                next
                  case Adversary_Receives_as_Client_case_2
                  solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                            <$Server.1, $url.3, <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                             sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)>)
                         ) @ #vk.68 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_1
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_2
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_3
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_4
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Compromise_Agent
                  by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_22
            by contradiction /* from formulas */
          next
            case Adversary_Receives_as_Client_case_23
            solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                      <$Server, $url.2, <'AuthnRequest', ~ltkSP, $SP.1, $Server>, 
                                       sign(<'AuthnRequest', ~ltkSP, $SP.1, $Server>, ~ltkSP.2)>)
                   ) @ #vk.45 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Client_case_24
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_25
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.52 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.75 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.69 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.79 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_26
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_27
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~ltkSP, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* cyclic */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_28
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_29
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.52 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.75 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.69 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.79 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_30
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~ltkSP, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* cyclic */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_31
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.52 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.75 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.69 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.79 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_01
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_02
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_03
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_04
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_05
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_06
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_07
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_08
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_09
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_10
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_11
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_12
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Register_Client_at_IdP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Register_Resource_at_SP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Compromise_Agent
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Initialize_Agent
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Register_Client_at_Compromised_IdP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case fresh
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          qed
        next
          case Adversary_Receives_as_Client_case_2
          solve( !KU( ~ltkSP ) @ #vk.34 )
            case Adversary_Receives_as_Client_case_01
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Receives_as_Client_case_02
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Receives_as_Client_case_03
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_04
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_05
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_06
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_07
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_08
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_09
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_10
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_11
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_12
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_13
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_14
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_15
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_16
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_17
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_18
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_19
            solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                             ~ltkSP.2)
                   ) @ #vk.54 )
              case Adversary_Receives_as_Client_case_1
              by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
            next
              case Adversary_Receives_as_Client_case_2
              by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
            next
              case c_sign
              solve( !KU( ~ltkSP.2 ) @ #vk.55 )
                case Adversary_Receives_as_Client_case_1
                by contradiction /* from formulas */
              next
                case Adversary_Receives_as_Client_case_2
                solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                          <$Server.1, $url.3, <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                           sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)>)
                       ) @ #vk.59 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_1
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_2
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_3
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_4
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Compromise_Agent
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_20
            by contradiction /* from formulas */
          next
            case Adversary_Receives_as_Client_case_21
            solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                      <$Server, $url.2, <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                       sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, ~ltkSP.2)>)
                   ) @ #vk.45 )
              case Adversary_Sends_as_Client
              solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                               ~ltkSP.2)
                     ) @ #vk.63 )
                case Adversary_Receives_as_Client_case_1
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              next
                case Adversary_Receives_as_Client_case_2
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              next
                case c_sign
                solve( !KU( ~ltkSP.2 ) @ #vk.64 )
                  case Adversary_Receives_as_Client_case_1
                  by contradiction /* from formulas */
                next
                  case Adversary_Receives_as_Client_case_2
                  solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                            <$Server.1, $url.3, <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                             sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)>)
                         ) @ #vk.68 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_1
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_2
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_3
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_4
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Compromise_Agent
                  by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_22
            by contradiction /* from formulas */
          next
            case Adversary_Receives_as_Client_case_23
            solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                      <$Server, $url.2, <'AuthnRequest', ~ltkSP, $SP.1, $Server>, 
                                       sign(<'AuthnRequest', ~ltkSP, $SP.1, $Server>, ~ltkSP.2)>)
                   ) @ #vk.45 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Client_case_24
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_25
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.52 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.75 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.69 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.79 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_26
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_27
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~ltkSP, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* cyclic */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_28
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_29
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.52 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.75 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.69 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.79 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_30
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~ltkSP, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* cyclic */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_31
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.52 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.75 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.69 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.79 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_01
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_02
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_03
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_04
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_05
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_06
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_07
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_08
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_09
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_10
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_11
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_12
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Register_Client_at_IdP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Register_Resource_at_SP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Compromise_Agent
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Initialize_Agent
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Register_Client_at_Compromised_IdP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case fresh
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          qed
        next
          case c_sign
          by contradiction /* from formulas */
        qed
      qed
    qed
  next
    case SP_Resource_Request_With_Artifact_case_1
    by contradiction /* from formulas */
  next
    case SP_Resource_Request_With_Artifact_case_2
    by contradiction /* from formulas */
  next
    case SP_Resource_Request_With_Artifact_case_3
    by contradiction /* from formulas */
  next
    case SP_Resource_Request_With_Artifact_case_4
    by contradiction /* from formulas */
  qed
qed

lemma sec_IdP_SP_Injective_Agreement:
  all-traces
  "∀ I S cid ida mh idr #i.
    (IdP_Params( I, S, cid, ida, mh, idr ) @ #i) ⇒
    ((∃ #j.
       (SP_Resource_Request_With_Artifact( S, I, ida, mh ) @ #j) ∧
       (¬(∃ I.1 S1 cid1 ida1 idr1 #i1.
           (IdP_Params( I.1, S1, cid1, ida1, mh, idr1 ) @ #i1) ∧ (¬(#i = #i1))))) ∨
     (∃ #j. Compromise_Agent( S ) @ #j))"
/*
guarded formula characterizing all counter-examples:
"∃ I S cid ida mh idr #i.
  (IdP_Params( I, S, cid, ida, mh, idr ) @ #i)
 ∧
  (∀ #j.
    (SP_Resource_Request_With_Artifact( S, I, ida, mh ) @ #j)
   ⇒
    ∃ I.1 S1 cid1 ida1 idr1 #i1.
     (IdP_Params( I.1, S1, cid1, ida1, mh, idr1 ) @ #i1) ∧ ¬(#i = #i1)) ∧
  (∀ #j. (Compromise_Agent( S ) @ #j) ⇒ ⊥)"
*/
simplify
solve( IdP_State_2( $IdP, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>,
                    <'Artifact', $IdP, ~messageHandle, ~id_authnrequest>, ~clientID
       ) ▶₀ #i )
  case IdP_Client_Authentication_case_1
  by contradiction /* from formulas */
next
  case IdP_Client_Authentication_case_2
  solve( !KU( https_request($IdP, ~client_ID_TLS_SP_IdP,
                            <
                             <'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                              ~messageHandle, ~id_authnrequest>, 
                             sign(<'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                                   ~messageHandle, ~id_authnrequest>,
                                  ~ltkSP)
                            >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Client
    solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve, $SP, 
                      'Artifact', $IdP, ~messageHandle, ~id_authnrequest>,
                     ~ltkSP)
           ) @ #vk.26 )
      case c_sign
      solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                                <$IdP, $url, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                                 sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)>)
             ) @ #vk.3 )
        case Adversary_Sends_as_Client
        solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)
               ) @ #vk.36 )
          case Adversary_Receives_as_Client_case_1
          solve( !KU( ~ltkSP ) @ #vk.34 )
            case Adversary_Receives_as_Client_case_01
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Receives_as_Client_case_02
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Receives_as_Client_case_03
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_04
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_05
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_06
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_07
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_08
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_09
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_10
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_11
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_12
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_13
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_14
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_15
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_16
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_17
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_18
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_19
            solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                             ~ltkSP.2)
                   ) @ #vk.54 )
              case Adversary_Receives_as_Client_case_1
              by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
            next
              case Adversary_Receives_as_Client_case_2
              by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
            next
              case c_sign
              solve( !KU( ~ltkSP.2 ) @ #vk.55 )
                case Adversary_Receives_as_Client_case_1
                by contradiction /* from formulas */
              next
                case Adversary_Receives_as_Client_case_2
                solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                          <$Server.1, $url.3, <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                           sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)>)
                       ) @ #vk.59 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_1
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_2
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_3
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_4
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Compromise_Agent
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_20
            by contradiction /* from formulas */
          next
            case Adversary_Receives_as_Client_case_21
            solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                      <$Server, $url.2, <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                       sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, ~ltkSP.2)>)
                   ) @ #vk.45 )
              case Adversary_Sends_as_Client
              solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                               ~ltkSP.2)
                     ) @ #vk.63 )
                case Adversary_Receives_as_Client_case_1
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              next
                case Adversary_Receives_as_Client_case_2
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              next
                case c_sign
                solve( !KU( ~ltkSP.2 ) @ #vk.64 )
                  case Adversary_Receives_as_Client_case_1
                  by contradiction /* from formulas */
                next
                  case Adversary_Receives_as_Client_case_2
                  solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                            <$Server.1, $url.3, <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                             sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)>)
                         ) @ #vk.68 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_1
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_2
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_3
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_4
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Compromise_Agent
                  by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_22
            by contradiction /* from formulas */
          next
            case Adversary_Receives_as_Client_case_23
            solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                      <$Server, $url.2, <'AuthnRequest', ~ltkSP, $SP.1, $Server>, 
                                       sign(<'AuthnRequest', ~ltkSP, $SP.1, $Server>, ~ltkSP.2)>)
                   ) @ #vk.45 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Client_case_24
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_25
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.52 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.75 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.69 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.79 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_26
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_27
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~ltkSP, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* cyclic */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_28
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_29
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.52 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.75 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.69 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.79 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_30
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~ltkSP, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* cyclic */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_31
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.52 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.75 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.69 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.79 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_01
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_02
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_03
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_04
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_05
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_06
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_07
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_08
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_09
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_10
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_11
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_12
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Register_Client_at_IdP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Register_Resource_at_SP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Compromise_Agent
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Initialize_Agent
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Register_Client_at_Compromised_IdP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case fresh
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          qed
        next
          case Adversary_Receives_as_Client_case_2
          solve( !KU( ~ltkSP ) @ #vk.34 )
            case Adversary_Receives_as_Client_case_01
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Receives_as_Client_case_02
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Receives_as_Client_case_03
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_04
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_05
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_06
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_07
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_08
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_09
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_10
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_11
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_12
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_13
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_14
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_15
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_16
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_17
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_18
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.83 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.48 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.85 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.90 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.88 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.48 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.56 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.59 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.75 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_19
            solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                             ~ltkSP.2)
                   ) @ #vk.54 )
              case Adversary_Receives_as_Client_case_1
              by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
            next
              case Adversary_Receives_as_Client_case_2
              by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
            next
              case c_sign
              solve( !KU( ~ltkSP.2 ) @ #vk.55 )
                case Adversary_Receives_as_Client_case_1
                by contradiction /* from formulas */
              next
                case Adversary_Receives_as_Client_case_2
                solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                          <$Server.1, $url.3, <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                           sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)>)
                       ) @ #vk.59 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_1
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_2
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_3
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_4
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Compromise_Agent
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_20
            by contradiction /* from formulas */
          next
            case Adversary_Receives_as_Client_case_21
            solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                      <$Server, $url.2, <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                       sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, ~ltkSP.2)>)
                   ) @ #vk.45 )
              case Adversary_Sends_as_Client
              solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                               ~ltkSP.2)
                     ) @ #vk.63 )
                case Adversary_Receives_as_Client_case_1
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              next
                case Adversary_Receives_as_Client_case_2
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              next
                case c_sign
                solve( !KU( ~ltkSP.2 ) @ #vk.64 )
                  case Adversary_Receives_as_Client_case_1
                  by contradiction /* from formulas */
                next
                  case Adversary_Receives_as_Client_case_2
                  solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                            <$Server.1, $url.3, <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                             sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)>)
                         ) @ #vk.68 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_1
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_2
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_3
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_4
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.66 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Compromise_Agent
                  by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_22
            by contradiction /* from formulas */
          next
            case Adversary_Receives_as_Client_case_23
            solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                      <$Server, $url.2, <'AuthnRequest', ~ltkSP, $SP.1, $Server>, 
                                       sign(<'AuthnRequest', ~ltkSP, $SP.1, $Server>, ~ltkSP.2)>)
                   ) @ #vk.45 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Client_case_24
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_25
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.52 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.75 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.69 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.79 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_26
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_27
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~ltkSP, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* cyclic */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_28
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_29
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.52 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.75 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.69 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.79 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_30
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~ltkSP, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                by contradiction /* cyclic */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_31
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.58 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.52 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.75 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.69 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.79 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.77 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_01
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_02
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_03
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_04
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.45 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_05
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_06
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_07
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_08
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_09
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_10
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_11
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_12
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.43 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Register_Client_at_IdP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Register_Resource_at_SP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Compromise_Agent
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Initialize_Agent
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Register_Client_at_Compromised_IdP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case fresh
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          qed
        next
          case c_sign
          by contradiction /* from formulas */
        qed
      qed
    qed
  next
    case SP_Resource_Request_With_Artifact_case_1
    solve( IdP_State_2( $IdP.1,
                        <'AuthnRequest', ~id_authnrequest.1, $SP.1, $IdP.1>,
                        <'Artifact', $IdP.1, ~messageHandle, ~id_authnrequest.1>, ~clientID.9
           ) ▶₀ #i1 )
      case IdP_Client_Authentication
      by contradiction /* from formulas */
    qed
  next
    case SP_Resource_Request_With_Artifact_case_2
    solve( IdP_State_2( $IdP.1,
                        <'AuthnRequest', ~id_authnrequest.1, $SP.1, $IdP.1>,
                        <'Artifact', $IdP.1, ~messageHandle, ~id_authnrequest.1>, ~clientID.9
           ) ▶₀ #i1 )
      case IdP_Client_Authentication
      by contradiction /* from formulas */
    qed
  next
    case SP_Resource_Request_With_Artifact_case_3
    solve( IdP_State_2( $IdP.1,
                        <'AuthnRequest', ~id_authnrequest.1, $SP.1, $IdP.1>,
                        <'Artifact', $IdP.1, ~messageHandle, ~id_authnrequest.1>, ~clientID.9
           ) ▶₀ #i1 )
      case IdP_Client_Authentication
      by contradiction /* from formulas */
    qed
  next
    case SP_Resource_Request_With_Artifact_case_4
    solve( IdP_State_2( $IdP.1,
                        <'AuthnRequest', ~id_authnrequest.1, $SP.1, $IdP.1>,
                        <'Artifact', $IdP.1, ~messageHandle, ~id_authnrequest.1>, ~clientID.9
           ) ▶₀ #i1 )
      case IdP_Client_Authentication
      by contradiction /* from formulas */
    qed
  qed
qed

lemma sec_IdP_SP_Assertion_Secrecy:
  all-traces
  "∀ S I sec #i.
    (IdP_Assertion_Secret( I, S, sec ) @ #i) ⇒
    ((¬(∃ #k. K( sec ) @ #k)) ∨ (∃ #k. Compromise_Agent( S ) @ #k))"
/*
guarded formula characterizing all counter-examples:
"∃ S I sec #i.
  (IdP_Assertion_Secret( I, S, sec ) @ #i)
 ∧
  (∃ #k. (K( sec ) @ #k)) ∧ (∀ #k. (Compromise_Agent( S ) @ #k) ⇒ ⊥)"
*/
simplify
solve( IdP_State_2( $IdP, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>,
                    <'Artifact', $IdP, ~messageHandle, ~id_authnrequest>, ~clientID
       ) ▶₀ #i )
  case IdP_Client_Authentication_case_1
  by contradiction /* from formulas */
next
  case IdP_Client_Authentication_case_2
  solve( !KU( https_request($IdP, ~client_ID_TLS_SP_IdP,
                            <
                             <'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                              ~messageHandle, ~id_authnrequest>, 
                             sign(<'ArtifactResolve', ~id_artifactresolve, $SP, 'Artifact', $IdP, 
                                   ~messageHandle, ~id_authnrequest>,
                                  ~ltkSP)
                            >)
         ) @ #vk.1 )
    case Adversary_Sends_as_Client
    solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve, $SP, 
                      'Artifact', $IdP, ~messageHandle, ~id_authnrequest>,
                     ~ltkSP)
           ) @ #vk.27 )
      case c_sign
      solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                                <$IdP, $url, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                                 sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)>)
             ) @ #vk.4 )
        case Adversary_Sends_as_Client
        solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP.1)
               ) @ #vk.37 )
          case Adversary_Receives_as_Client_case_1
          solve( !KU( ~ltkSP ) @ #vk.35 )
            case Adversary_Receives_as_Client_case_01
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Receives_as_Client_case_02
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Receives_as_Client_case_03
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_04
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_05
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_06
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_07
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.60 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.76 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_08
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.60 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.76 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_09
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.60 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.76 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_10
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.60 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.76 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_11
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_12
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_13
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_14
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_15
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.60 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.76 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_16
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.60 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.76 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_17
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.60 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.76 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_18
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.60 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.76 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_19
            solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                             ~ltkSP.2)
                   ) @ #vk.55 )
              case Adversary_Receives_as_Client_case_1
              by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
            next
              case Adversary_Receives_as_Client_case_2
              by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
            next
              case c_sign
              solve( !KU( ~ltkSP.2 ) @ #vk.56 )
                case Adversary_Receives_as_Client_case_1
                by contradiction /* from formulas */
              next
                case Adversary_Receives_as_Client_case_2
                solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                          <$Server.1, $url.3, <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                           sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)>)
                       ) @ #vk.60 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_1
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.58 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_2
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.58 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_3
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.58 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_4
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.58 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Compromise_Agent
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_20
            by contradiction /* from formulas */
          next
            case Adversary_Receives_as_Client_case_21
            solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                      <$Server, $url.2, <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                       sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, ~ltkSP.2)>)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Client
              solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                               ~ltkSP.2)
                     ) @ #vk.64 )
                case Adversary_Receives_as_Client_case_1
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              next
                case Adversary_Receives_as_Client_case_2
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              next
                case c_sign
                solve( !KU( ~ltkSP.2 ) @ #vk.65 )
                  case Adversary_Receives_as_Client_case_1
                  by contradiction /* from formulas */
                next
                  case Adversary_Receives_as_Client_case_2
                  solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                            <$Server.1, $url.3, <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                             sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)>)
                         ) @ #vk.69 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_1
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.67 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_2
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.67 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_3
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.67 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_4
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.67 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Compromise_Agent
                  by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_22
            by contradiction /* from formulas */
          next
            case Adversary_Receives_as_Client_case_23
            solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                      <$Server, $url.2, <'AuthnRequest', ~ltkSP, $SP.1, $Server>, 
                                       sign(<'AuthnRequest', ~ltkSP, $SP.1, $Server>, ~ltkSP.2)>)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Client_case_24
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.59 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.50 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_25
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.59 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.50 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.53 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.76 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.70 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.80 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_26
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.59 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.50 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_27
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.59 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~ltkSP, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.50 )
                case Adversary_Sends_as_Client
                by contradiction /* cyclic */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_28
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.59 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.50 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_29
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.59 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.50 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.53 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.76 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.70 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.80 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_30
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.59 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~ltkSP, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.50 )
                case Adversary_Sends_as_Client
                by contradiction /* cyclic */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_31
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.59 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.50 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.53 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.76 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.70 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.80 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_01
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.46 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_02
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.46 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_03
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.46 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_04
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.46 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_05
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_06
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_07
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_08
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_09
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_10
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_11
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_12
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Register_Client_at_IdP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Register_Resource_at_SP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Compromise_Agent
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Initialize_Agent
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Register_Client_at_Compromised_IdP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case fresh
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          qed
        next
          case Adversary_Receives_as_Client_case_2
          solve( !KU( ~ltkSP ) @ #vk.35 )
            case Adversary_Receives_as_Client_case_01
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Receives_as_Client_case_02
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Receives_as_Client_case_03
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_04
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_05
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_06
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_07
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.60 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.76 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_08
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.60 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.76 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_09
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.60 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.76 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_10
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.60 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.76 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_11
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_12
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_13
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_14
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_15
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.60 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.76 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_16
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.60 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.76 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_17
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.60 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.76 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_18
            solve( !KU( https_response(~client_ID_TLS_SP_IdP.1,
                                       <
                                        <'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                         <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                          'Assertion', ~id_assertion.1, $IdP.1, 
                                          <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                          <'Audience', $Server>, ~assertion_secret.1>, 
                                         ResponseSignature>, 
                                        sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                              <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 
                                               'Assertion', ~id_assertion.1, $IdP.1, 
                                               <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                               <'Audience', $Server>, ~assertion_secret.1>, 
                                              ResponseSignature>,
                                             ~ltkIdP.1)
                                       >)
                   ) @ #vk.47 )
              case Adversary_Sends_as_Server
              solve( !KU( sign(<'ArtifactResponse', $IdP.1, ~id_artifactresolve.1, 
                                <'Response', ~id_response.1, $IdP.1, ~id_authnrequest.1, 'Assertion', 
                                 ~id_assertion.1, $IdP.1, <'Subject', ~clientID.10, ~id_authnrequest.1>, 
                                 <'Audience', $Server>, ~assertion_secret.1>, 
                                ResponseSignature>,
                               ~ltkIdP.1)
                     ) @ #vk.84 )
                case c_sign
                solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                          <'ResourceRequest', $url.3>)
                       ) @ #vk.49 )
                  case Adversary_Sends_as_Client
                  solve( !KU( ~ltkIdP.1 ) @ #vk.86 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                              <$Server.1, $url.4, 
                                               <'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, 
                                               sign(<'AuthnRequest', ~ltkIdP.1, $SP.1, $Server.1>, ~ltkSP.2)>)
                           ) @ #vk.91 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_1
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_2
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_3
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Adversary_Receives_as_Server_case_4
                    solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                              <<'Artifact', $Agent.3, ~ltkIdP.1, ~id_authnrequest.2>, $url.4>)
                           ) @ #vk.89 )
                      case Adversary_Sends_as_Client
                      by contradiction /* cyclic */
                    qed
                  next
                    case Compromise_Agent
                    by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                  qed
                qed
              qed
            next
              case IdP_Artifact_Resolution
              solve( !KU( https_request($Server, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.49 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($IdP.1, ~client_ID_TLS_C_IdP.1,
                                          <'IAuthAndConsent', ~clientID.2, $Server, $IdP.1, ~clientSecret.3, 
                                           ~auth_session.1>)
                       ) @ #vk.57 )
                  case Adversary_Sends_as_Client
                  solve( !KU( https_request($IdP.1, ~tls_session_id_C_IdP.1,
                                            <$IdP.1, $url.4, 
                                             <'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>, 
                                             sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                                  ~ltk.1)
                                            >)
                         ) @ #vk.60 )
                    case Adversary_Sends_as_Client
                    solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $Server, $IdP.1>,
                                     ~ltk.1)
                           ) @ #vk.76 )
                      case Adversary_Receives_as_Client
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    next
                      case c_sign
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_19
            solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                             ~ltkSP.2)
                   ) @ #vk.55 )
              case Adversary_Receives_as_Client_case_1
              by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
            next
              case Adversary_Receives_as_Client_case_2
              by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
            next
              case c_sign
              solve( !KU( ~ltkSP.2 ) @ #vk.56 )
                case Adversary_Receives_as_Client_case_1
                by contradiction /* from formulas */
              next
                case Adversary_Receives_as_Client_case_2
                solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.1,
                                          <$Server.1, $url.3, <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                           sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)>)
                       ) @ #vk.60 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_1
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.58 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_2
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.58 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_3
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.58 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Adversary_Receives_as_Server_case_4
                solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                          <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                       ) @ #vk.58 )
                  case Adversary_Sends_as_Client
                  by contradiction /* cyclic */
                qed
              next
                case Compromise_Agent
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_20
            by contradiction /* from formulas */
          next
            case Adversary_Receives_as_Client_case_21
            solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                      <$Server, $url.2, <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                       sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, ~ltkSP.2)>)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Client
              solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                               ~ltkSP.2)
                     ) @ #vk.64 )
                case Adversary_Receives_as_Client_case_1
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              next
                case Adversary_Receives_as_Client_case_2
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              next
                case c_sign
                solve( !KU( ~ltkSP.2 ) @ #vk.65 )
                  case Adversary_Receives_as_Client_case_1
                  by contradiction /* from formulas */
                next
                  case Adversary_Receives_as_Client_case_2
                  solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                            <$Server.1, $url.3, <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                             sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)>)
                         ) @ #vk.69 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_1
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.67 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_2
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.67 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_3
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.67 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Adversary_Receives_as_Server_case_4
                  solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                            <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3>)
                         ) @ #vk.67 )
                    case Adversary_Sends_as_Client
                    by contradiction /* cyclic */
                  qed
                next
                  case Compromise_Agent
                  by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_22
            by contradiction /* from formulas */
          next
            case Adversary_Receives_as_Client_case_23
            solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                      <$Server, $url.2, <'AuthnRequest', ~ltkSP, $SP.1, $Server>, 
                                       sign(<'AuthnRequest', ~ltkSP, $SP.1, $Server>, ~ltkSP.2)>)
                   ) @ #vk.46 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Client_case_24
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.59 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.50 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_25
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.59 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.50 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.53 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.76 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.70 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.80 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_26
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.59 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.50 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_27
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.59 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~ltkSP, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.50 )
                case Adversary_Sends_as_Client
                by contradiction /* cyclic */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_28
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.59 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.50 )
                case Adversary_Sends_as_Client
                by contradiction /* from formulas */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_29
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.59 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.50 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.53 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.76 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.70 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.80 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_30
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.59 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~ltkSP, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.50 )
                case Adversary_Sends_as_Client
                by contradiction /* cyclic */
              qed
            qed
          next
            case Adversary_Receives_as_Client_case_31
            solve( !KU( sign(<'ArtifactResolve', ~id_artifactresolve.1, $SP.1, 
                              'Artifact', $Server, ~messageHandle.1, ~id_authnrequest.1>,
                             ~ltkSP.2)
                   ) @ #vk.59 )
              case c_sign
              solve( !KU( https_request($Server, ~client_ID_TLS_C_IdP.1,
                                        <'IAuthAndConsent', ~clientID.1, $SP.1, $Server, ~clientSecret.3, 
                                         ~auth_session.1>)
                     ) @ #vk.50 )
                case Adversary_Sends_as_Client
                solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                          <$Server, $url.2, 
                                           <'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>, 
                                           sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                                ~ltkSP.2)
                                          >)
                       ) @ #vk.53 )
                  case Adversary_Sends_as_Client
                  solve( !KU( sign(<'AuthnRequest', ~id_authnrequest.1, $SP.1, $Server>,
                                   ~ltkSP.2)
                         ) @ #vk.76 )
                    case Adversary_Receives_as_Client_case_1
                    by contradiction /* from formulas */
                  next
                    case Adversary_Receives_as_Client_case_2
                    by contradiction /* from formulas */
                  next
                    case c_sign
                    solve( !KU( ~ltkSP.2 ) @ #vk.70 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server.1, ~tls_session_id_C_IdP.2,
                                                <$Server.1, $url.3, 
                                                 <'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, 
                                                 sign(<'AuthnRequest', ~ltkSP.2, $SP.2, $Server.1>, ~ltkSP.3)
                                                >)
                             ) @ #vk.80 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.2, ~client_ID_TLS_C_SP,
                                                <<'Artifact', $Agent.3, ~ltkSP.2, ~id_authnrequest.2>, $url.3
                                                >)
                             ) @ #vk.78 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Compromise_Agent
                      by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_01
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.46 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_02
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.46 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_03
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.46 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_04
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              solve( !KU( https_request($SP.1, ~tls_session_id_C_SP,
                                        <'ResourceRequest', $url.3>)
                     ) @ #vk.46 )
                case Adversary_Sends_as_Client
                by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
              qed
            qed
          next
            case Adversary_Receives_as_Server_case_05
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_06
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_07
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_08
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~ltkSP, ~id_authnrequest.1>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_09
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_10
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_11
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Receives_as_Server_case_12
            solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP,
                                      <<'Artifact', $Agent.2, ~messageHandle.1, ~ltkSP>, $url.2>)
                   ) @ #vk.44 )
              case Adversary_Sends_as_Client
              by contradiction /* cyclic */
            qed
          next
            case Adversary_Register_Client_at_IdP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Adversary_Register_Resource_at_SP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Compromise_Agent
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Initialize_Agent
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case Register_Client_at_Compromised_IdP
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          next
            case fresh
            by solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          qed
        next
          case c_sign
          by contradiction /* from formulas */
        qed
      qed
    qed
  next
    case SP_Resource_Request_With_Artifact_case_1
    solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                              <$IdP, $url, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                               sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)>)
           ) @ #vk.4 )
      case Adversary_Sends_as_Client
      solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)
             ) @ #vk.33 )
        case Adversary_Receives_as_Client
        solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          case Initialize_Agent
          solve( !Ltk( $IdP, ~ltkIdP ) ▶₂ #i )
            case Initialize_Agent
            solve( !Client_Registered_at_IdP( $IdP, ~clientID, ~clientSecret
                   ) ▶₃ #i )
              case Adversary_Register_Client_at_IdP
              solve( New_Server_TLS_Session( $IdP, ~client_ID_TLS_SP_IdP ) ▶₄ #i )
                case Client_Starts_TLS
                solve( New_Id( ~id_assertion ) ▶₇ #i )
                  case Generate_New_Id
                  solve( New_Id( ~id_response ) ▶₈ #i )
                    case Generate_New_Id
                    solve( !KU( ~assertion_secret ) @ #vk.10 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                                <$Server, $url.3, 
                                                 <'AuthnRequest', ~assertion_secret, $SP.1, $Server>, 
                                                 sign(<'AuthnRequest', ~assertion_secret, $SP.1, $Server>,
                                                      ~ltkSP.1)
                                                >)
                             ) @ #vk.41 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                                <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                                 $url.3>)
                             ) @ #vk.39 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                                <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                                 $url.3>)
                             ) @ #vk.39 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                                <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                                 $url.3>)
                             ) @ #vk.39 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                                <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                                 $url.3>)
                             ) @ #vk.39 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      next
        case c_sign
        by contradiction /* from formulas */
      qed
    qed
  next
    case SP_Resource_Request_With_Artifact_case_2
    solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                              <$IdP, $url, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                               sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)>)
           ) @ #vk.4 )
      case Adversary_Sends_as_Client
      solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)
             ) @ #vk.33 )
        case Adversary_Receives_as_Client
        solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          case Initialize_Agent
          solve( !Ltk( $IdP, ~ltkIdP ) ▶₂ #i )
            case Initialize_Agent
            solve( !Client_Registered_at_IdP( $IdP, ~clientID, ~clientSecret
                   ) ▶₃ #i )
              case Adversary_Register_Client_at_IdP
              solve( New_Server_TLS_Session( $IdP, ~client_ID_TLS_SP_IdP ) ▶₄ #i )
                case Client_Starts_TLS
                solve( New_Id( ~id_assertion ) ▶₇ #i )
                  case Generate_New_Id
                  solve( New_Id( ~id_response ) ▶₈ #i )
                    case Generate_New_Id
                    solve( !KU( ~assertion_secret ) @ #vk.10 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                                <$Server, $url.3, 
                                                 <'AuthnRequest', ~assertion_secret, $SP.1, $Server>, 
                                                 sign(<'AuthnRequest', ~assertion_secret, $SP.1, $Server>,
                                                      ~ltkSP.1)
                                                >)
                             ) @ #vk.41 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                                <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                                 $url.3>)
                             ) @ #vk.39 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                                <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                                 $url.3>)
                             ) @ #vk.39 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                                <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                                 $url.3>)
                             ) @ #vk.39 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                                <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                                 $url.3>)
                             ) @ #vk.39 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      next
        case c_sign
        by contradiction /* from formulas */
      qed
    qed
  next
    case SP_Resource_Request_With_Artifact_case_3
    solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                              <$IdP, $url, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                               sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)>)
           ) @ #vk.4 )
      case Adversary_Sends_as_Client
      solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)
             ) @ #vk.33 )
        case Adversary_Receives_as_Client
        solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          case Initialize_Agent
          solve( !Ltk( $IdP, ~ltkIdP ) ▶₂ #i )
            case Initialize_Agent
            solve( !Client_Registered_at_IdP( $IdP, ~clientID, ~clientSecret
                   ) ▶₃ #i )
              case Adversary_Register_Client_at_IdP
              solve( New_Server_TLS_Session( $IdP, ~client_ID_TLS_SP_IdP ) ▶₄ #i )
                case Client_Starts_TLS
                solve( New_Id( ~id_assertion ) ▶₇ #i )
                  case Generate_New_Id
                  solve( New_Id( ~id_response ) ▶₈ #i )
                    case Generate_New_Id
                    solve( !KU( ~assertion_secret ) @ #vk.10 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                                <$Server, $url.3, 
                                                 <'AuthnRequest', ~assertion_secret, $SP.1, $Server>, 
                                                 sign(<'AuthnRequest', ~assertion_secret, $SP.1, $Server>,
                                                      ~ltkSP.1)
                                                >)
                             ) @ #vk.41 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                                <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                                 $url.3>)
                             ) @ #vk.39 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                                <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                                 $url.3>)
                             ) @ #vk.39 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                                <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                                 $url.3>)
                             ) @ #vk.39 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                                <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                                 $url.3>)
                             ) @ #vk.39 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      next
        case c_sign
        by contradiction /* from formulas */
      qed
    qed
  next
    case SP_Resource_Request_With_Artifact_case_4
    solve( !KU( https_request($IdP, ~tls_session_id_C_IdP,
                              <$IdP, $url, <'AuthnRequest', ~id_authnrequest, $SP, $IdP>, 
                               sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)>)
           ) @ #vk.4 )
      case Adversary_Sends_as_Client
      solve( !KU( sign(<'AuthnRequest', ~id_authnrequest, $SP, $IdP>, ~ltkSP)
             ) @ #vk.33 )
        case Adversary_Receives_as_Client
        solve( !Ltk( $SP, ~ltkSP ) ▶₁ #i )
          case Initialize_Agent
          solve( !Ltk( $IdP, ~ltkIdP ) ▶₂ #i )
            case Initialize_Agent
            solve( !Client_Registered_at_IdP( $IdP, ~clientID, ~clientSecret
                   ) ▶₃ #i )
              case Adversary_Register_Client_at_IdP
              solve( New_Server_TLS_Session( $IdP, ~client_ID_TLS_SP_IdP ) ▶₄ #i )
                case Client_Starts_TLS
                solve( New_Id( ~id_assertion ) ▶₇ #i )
                  case Generate_New_Id
                  solve( New_Id( ~id_response ) ▶₈ #i )
                    case Generate_New_Id
                    solve( !KU( ~assertion_secret ) @ #vk.10 )
                      case Adversary_Receives_as_Client_case_1
                      by contradiction /* from formulas */
                    next
                      case Adversary_Receives_as_Client_case_2
                      solve( !KU( https_request($Server, ~tls_session_id_C_IdP.1,
                                                <$Server, $url.3, 
                                                 <'AuthnRequest', ~assertion_secret, $SP.1, $Server>, 
                                                 sign(<'AuthnRequest', ~assertion_secret, $SP.1, $Server>,
                                                      ~ltkSP.1)
                                                >)
                             ) @ #vk.41 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_1
                      solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                                <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                                 $url.3>)
                             ) @ #vk.39 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_2
                      solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                                <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                                 $url.3>)
                             ) @ #vk.39 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_3
                      solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                                <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                                 $url.3>)
                             ) @ #vk.39 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adversary_Receives_as_Server_case_4
                      solve( !KU( https_request($SP.1, ~client_ID_TLS_C_SP.1,
                                                <<'Artifact', $Agent, ~assertion_secret, ~id_authnrequest.1>, 
                                                 $url.3>)
                             ) @ #vk.39 )
                        case Adversary_Sends_as_Client
                        by contradiction /* cyclic */
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      next
        case c_sign
        by contradiction /* from formulas */
      qed
    qed
  qed
qed

/* All well-formedness checks were successful. */

end